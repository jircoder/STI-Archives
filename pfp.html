<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Profile STI ARCHIVES</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/2.10.377/pdf.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        body  {
            min-height: 100vh;
            margin: 0;
            display:flex;
            flex-direction: column;
            font-family: 'Poppins', Arial, sans-serif;
            background: #fff;   /* FIXED background */
            max-width: 100vw;

        }
      
        .main-navbar {
            display: flex;
            align-items: center;
            justify-content: space-between;
            top: 0;
            height: 65px;
            width: 100%;
            color: #595d69;
            background: #fff;
            box-shadow: 0 2px 8px #0001;
            padding: 0 12px;
            z-index: 1000;
            position: fixed;
            transition: height 0.3s ease;
        }

        .main-navbar.shrink {
            position: fixed;
            height: 50px;
            box-shadow: 0 4px 12px #0003;
        }
       
    .main-navbar  a{

    text-decoration: none;
    font-family: "Alan Sans";


}
       .sti-logo {
           display: flex;
           align-items: center;
           height: 40px;
           width: auto;
           border-radius: 6px;
           margin-left: 30px;
       }

       .sti-logo span {
           font-size: 24px;
           font-weight: 700;
           color: #0057b8;
           margin-left: 10px;
           user-select: none;
       }
       
        .sti-logo a {
            text-decoration: none;
        }

        .main-navbar.shrink .sti-logo {
            height: 34px;
            margin-top: 0;
        }

        .main-navbar.shrink .sti-logo span {
            font-size: 22px;
        }

        .main-navbar.shrink .nav-text {
            font-size: 24px;
        }

        .main-navbar.shrink .navbar-right.user-nav-fixed .fa-user-circle {
            font-size: 26px;
        }

        .main-navbar.shrink .dark-mode-toggle {
            font-size: 20px;
        }

        .nav-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0;

        }

        .nav-text {
            font-size: 18px;
            color: #1e1e1f;
            cursor: default;
            margin: 0;
        }
        
        .navbar-right.user-nav-fixed {
            position: absolute;
            right: 12px;
            top: 50%;
            transform: translateY(-50%);
            display: flex;
            align-items: center;
            gap: 14px;
            font-family: 'Poppins', Arial, sans-serif;
            font-weight: 600;
            color: #132a3f;
            font-size: 16px;
            z-index: 20;
        }

        .dark-mode-toggle {
            background: none;
            border: none;
            outline: none;
            cursor: pointer;
            margin-left: 8px;
            font-size: 24px;
            color: #ffd700;
            display: flex;
            align-items: center;
        }

        .fa-user-circle {
            font-size: 28px;
            color: #0057b8;
        }

        .dark-mode .fa-user-circle {
            color: #ffd700;
        }
        

        .navbar-right {
             display: flex;
             align-items: center;
             gap: 12px;
             font-family: 'Poppins', Arial, sans-serif;
             font-weight: 600;
             color: #132a3f;
             font-size: 18px;
             margin-right:30px;
             transition: font-size 0.4s cubic-bezier(0.4, 0, 0.2, 1), gap 0.4s cubic-bezier(0.4, 0, 0.2, 1);

         }
        .navbar-right i {
            font-size: 28px;
            
            
        }
        .navbar-right.user-nav-fixed {
            position: absolute;
            right: 12px;
            top: 50%;
            transform: translateY(-50%);
            display: flex;
            align-items: center;
            gap: 14px;
            font-family: 'Poppins', Arial, sans-serif;
            font-weight: 600;
            color: #132a3f;
            font-size: 18px;
            z-index: 20;
        }
        .navbar-right.user-nav-fixed .user-name {
            font-size: 18px;
            color: #132a3f;
            font-weight: 600;
            white-space: nowrap;
        }
        .navbar-right.user-nav-fixed .fa-user-circle {
            font-size: 32px;
            color: #0057b8;
        }
        .dark-mode .fa-user-circle {
            color: #ffd700;
        }
        .nav-icons-center {
             position: absolute;
             left: 50%;
             transform: translateX(-50%);
             display: flex;
             gap: 25px;
             color:#1e1e1f;
             align-items: center;
             font-family: 'Poppins', Arial, sans-serif;
             transition: opacity 0.4s cubic-bezier(0.4, 0, 0.2, 1);
         }
        
        
       
        
        .dark-mode .nav-text {
            color: #ffd700;
        }
        .dark-mode .main-navbar.shrink .nav-text {
            color: #ffd700;
        }
        
       /* Sidebar */
        .sidebar {
            position: fixed;
            top: 8%;
            margin-right:10px;
            right: -320px;
            width: 260px;
            height: 65%;
            background: #fff;
            box-shadow: -2px 0 16px #0002;
            z-index: 100;
            transition: right 0.3s cubic-bezier(.4,2,.6,1), visibility 0.3s;
            display: flex;
            flex-direction: column;
            visibility: hidden; /* Hide by default */
            pointer-events: none; /* Prevent interaction when hidden */
            z-index: 10002;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            font-size: 24px;
        }
        .sidebar.open {
            right: 0;
            visibility: visible; /* Show when open */
            pointer-events: auto;
        }
        .sidebar-content {
            padding: 32px 24px 24px 24px;
            flex: 1;
            display: flex;
            flex-direction: column;
        }
        .close-sidebar {
            background: none;
            border: none;
            font-size: 2rem;
            color: #0057b8;
            align-self: flex-end;
            cursor: pointer;
            margin-bottom: 16px;
        }
        .sidebar-content h3 {
            margin: 0 0 24px 0;
            color: #0057b8;
            font-size: 1.3rem;
            font-weight: 700;
        }
        .sidebar-content ul {
             list-style: none;
             padding: 0 0 0 8px;
             margin: 0;
             flex: 1;
         }
        .sidebar-content ul li {
            margin-bottom: 5px;
        }
        .sidebar-content ul li a {
            color: #132a3f;
            text-decoration: none;
            font-size: 1.1rem;
            font-weight: 500;
            transition: color 0.2s;
        }
        .sidebar-content ul li a:hover {
            color: #0057b8;
        }
        .account-switcher {
            margin-left: auto;
        }
        .sidebar-content ul {
            margin-top: 20px;
            font-size: 20px;
            font-weight: 600;
        }
        .user-info {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        #user-Icon {
            font-size: 30px;
            color: #0057b8;
        }
        .user-name h3 {
            margin: 0;
            font-size: 20px;
        }
        .user-name a {
            text-decoration: none;
            color: inherit;
        }
        
        .dark-mode #user-Icon {
            color: #ffd700;
        }
        .dark-mode .fa-arrow-right-from-bracket {
            color: #ffd700 !important;
        }
        .sidebar-content ul li a {
            color: #0057b8;
            font-size: 1.1rem;
            font-weight: 500;
        }/*END SIDEBAR*/
        @media (max-width: 845px) {
            .hamburger {
                display: flex;
            }
            .nav-icons-center {
                display: none;
            }
        }

        .sdbr ul{
            list-style: none;
        }
        .sdbr1 {
            padding-top:20px;
            left:0;
            top:65px;
            width:200px;
            height: calc(100vh - 65px);
            z-index:10;
            position:fixed;
            justify-items: left;
            transition: width 0.3s ease;
        }

        .sdbr1.collapsed {
            width: 50px;
        }

        .sdbr1.collapsed .sdbr1-menu {
            display: none;
            transition: opacity 0.3s ease;
        }

        .sdbr1.collapsed .collapsed-menu {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: flex-start;
            gap: 20px;
            padding-top: 50px;
            width: 100%;
            text-align: center;
            transition: opacity 0.3s ease;
        }

        .collapsed-menu {
            display: none;
        }

        .collapsed-menu-item {
            font-size: 24px;
            color: #331801;
            cursor: pointer;
            transition: none;
            position: relative;
        }

        .collapsed-menu-item:hover {
            color: #0057b8;
        }

        .collapsed-dropdown {
            display: none;
            position: absolute;
            left: 100%;
            top: 0;
            background: #fff;
            border: 1px solid #ddd;
            border-radius: 4px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            z-index: 10;
            min-width: 150px;
            padding: 8px 0;
        }

        .collapsed-menu-item:hover .collapsed-dropdown {
            display: block;
        }

        .collapsed-dropdown div {
            padding: 8px 16px;
            cursor: pointer;
            color: #331801;
            font-size: 14px;
            transition: background 0.2s ease;
        }

        .collapsed-dropdown div:hover {
            background: rgba(0, 87, 184, 0.1);
        }

        .toggle-collapse {
            position: absolute;
            top: 10px;
            left: 10px;
            background: none;
            border: none;
            font-size: 20px;
            color: #331801;
            cursor: pointer;
            z-index: 15;
            padding-left:5px;
            
        }

        .sdbr1.collapsed .toggle-collapse {
            left: 50%;
            transform: translateX(-50%);
            padding:0px;
            transition: none;
        }
        .sdbr1-menu {
            list-style: none;
            text-decoration: none;
            padding: 0 0 0 30px;
            margin-top: 30px;
            font-size: 1rem;
            font-weight: 600;
            justify-items: left;
            
        }
        .sdbr1-menu li {
            margin-bottom: 15px;
            
        }
        .sdbr1-menu li {
            margin-bottom: 15px;
            text-decoration: none;
            color:#331801;
            transition: background 0.2s ease;
            padding: 5px 10px;
            border-radius: 4px;
            cursor: pointer;
            font-weight: normal;
        }

        .sdbr1-menu li:hover {
            background: rgba(0, 87, 184, 0.1);
        }

        .sdbr1-menu li.dropdown-item {
            cursor: pointer;
        }

        .sdbr1-menu li.dropdown-item:hover {
            background: rgba(0, 87, 184, 0.1);
        }

        .sdbr1-menu li.active {
            background: rgba(0, 87, 184, 0.2) !important;
            border-left: 3px solid #0057b8 !important;
        }

        .menu-header {
            cursor: default;
            padding: 10px 0;
            color: #000000;
            font-size: 1.5rem;
            font-weight: 600;
            justify-items: left;
            display: flex;
            align-items: center;
            justify-content: space-between;
            position: relative;
            width: 100%;
            min-width: 140px;
            background: transparent;
            pointer-events: none;
        }

        .menu-header:hover {
            background: transparent;
        }

        .menu-header {
            cursor: default;
            padding: 10px 0;
            color: #000000;
            font-size: 1.5rem;
            font-weight: 600;
            justify-items: left;
            display: flex;
            align-items: center;
            justify-content: space-between;
            position: relative;
            width: 100%;
            min-width: 140px;
            background: transparent;
            pointer-events: none;
        }

        .menu-header:hover {
            background: transparent;
        }

        /* Account Settings Styles */
        .account-section {
            margin-bottom: 0;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 8px;
            border: 1px solid #e9ecef;
        }

        .account-section:not(:last-child) {
            margin-bottom: 0;
        }

        .account-section h3 {
            margin: 0 0 15px 0;
            color: #0057b8;
            font-size: 1.2rem;
            font-weight: 600;
        }

        .mini-profile-container {
            display: flex;
            align-items: center;
            gap: 20px;
            margin-bottom: 15px;
        }

        .mini-background-image-container {
            position: relative;
            width: 120px;
            height: 70px;
            border-radius: 10px;
            
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            background-size: cover;
            background-position: center;
            background-repeat: no-repeat;
        }

        .mini-pfp-container {
            position: absolute;
            top: 45px;
            left: 50%;
            transform: translateX(-50%);
            width: 60px;
            height: 60px;
            border-radius: 50%;
            
            border: 3px solid #fff;
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
        }

        .mini-pfp-pic {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 50%;
        }

        .mini-profile-buttons {
            display: flex;
            flex-direction: row;
            gap: 8px;
            margin-left: 20px;
        }

        .mini-upload-btn, .mini-delete-btn {
            padding: 8px 16px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: background 0.2s ease;
        }

        .mini-upload-btn {
            background: #0057b8;
            color: white;
        }

        .mini-upload-btn:hover {
            background: #003f8a;
        }

        .mini-delete-btn {
            background: #dc3545;
            color: white;
        }

        .mini-delete-btn:hover {
            background: #c82333;
        }

        .email-section {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 0;
            background: white;
            border-radius: 6px;
        }

        .email-section input {
            flex: 1;
            padding: 10px;
            border: 1px solid #dee2e6;
            border-radius: 4px;
            font-size: 1rem;
            background: white;
            color: #333;
        }

        .email-section input:focus {
            outline: none;
            border-color: #0057b8;
            box-shadow: 0 0 0 2px rgba(0, 87, 184, 0.25);
        }

        .email-section input[readonly] {
            background: #f8f9fa;
            cursor: not-allowed;
        }

        .update-email-btn {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px 16px;
            background: #28a745;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: background 0.2s ease;
        }

        .update-email-btn:hover {
            background: #218838;
        }

        .password-section {
            display: flex;
            flex-direction: column;
            gap: 12px;
            padding: 0;
        }

        .password-input-container {
            position: relative;
            display: flex;
            align-items: center;
        }

        .password-icon {
            position: absolute;
            left: 12px;
            color: #6c757d;
            font-size: 1rem;
        }

        .password-input {
            width: 100%;
            padding: 12px 12px 12px 40px;
            border: 1px solid #dee2e6;
            border-radius: 4px;
            font-size: 1rem;
            background: white;
        }

        .password-input:focus {
            outline: none;
            border-color: #0057b8;
            box-shadow: 0 0 0 2px rgba(0, 87, 184, 0.25);
        }

        .password-toggle {
            position: absolute;
            right: 12px;
            color: #6c757d;
            cursor: pointer;
            font-size: 1rem;
            transition: color 0.2s ease;
        }

        .password-toggle:hover {
            color: #0057b8;
        }

        .update-password-btn {
            align-self: flex-start;
            padding: 10px 20px;
            background: #007bff;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: background 0.2s ease;
        }

        .update-password-btn:hover {
            background: #0056b3;
        }

        /* Friends Section Styles */
        .friends-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
            gap: 30px;
            padding: 20px 0;
        }

        .friend-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 15px;
            transition: transform 0.2s ease;
            cursor: pointer;
        }

        .friend-item:hover {
            transform: scale(1.05);
        }

        .friend-avatar {
            margin-bottom: 15px;
        }

        .friend-avatar i {
            font-size: 72px;
            color: #0057b8;
        }

        .friend-name {
            font-size: 18px;
            font-weight: 500;
            color: #333;
            text-align: center;
        }

        .name-section {
            margin-top: 20px;
            padding-top: 20px;
            border-top: 1px solid #e9ecef;
        }

        .name-row {
            display: flex;
            gap: 15px;
        }

        .name-input-group {
            flex: 1;
        }

        .name-input-group label {
            display: block;
            margin-bottom: 5px;
            font-weight: 500;
            color: #333;
            font-size: 0.9rem;
        }

        .name-input-group input {
            width: 100%;
            padding: 10px;
            border: 1px solid #dee2e6;
            border-radius: 4px;
            font-size: 1rem;
            background: white;
        }

        .name-input-group input:focus {
            outline: none;
            border-color: #0057b8;
            box-shadow: 0 0 0 2px rgba(0, 87, 184, 0.25);
        }
        .sdbr1-menu .sub-dropdown {
            position: relative;
            
        }
        .menu-header {
            cursor: default;
            padding: 10px 0;
            color: #000000;
            font-size: 1.5rem;
            font-weight: 600;
            justify-items: left;
            display: flex;
            align-items: center;
            justify-content: space-between;
            position: relative;
            width: 100%;
            min-width: 140px;
            background: transparent;
        }
        .sdbr1-menu .sub-dropdown-menu {
            display: none;
            background: transparent;
            padding: 0;
        }
        .sdbr1-menu .sub-dropdown.open .sub-dropdown-menu {
            display: block;
        }
        .sdbr1-menu .sub-dropdown-menu .dropdown-item {
            padding: 6px 6px 6px 5px;
            cursor: pointer;
            transition: background 0.2s;
            color: #331801;
        }
        .dropdown-item:hover {
            background: #f8f9fa;
        }
        .fa-chevron-down {
            transition: transform 0.3s ease;
            font-size: 10px;
        }
        .sdbr1-menu .sub-dropdown.open .fa-chevron-down {
            transform: rotate(180deg);
            position: relative;
            left: 0;
        }
        

        .pfp-container {
            position: relative;
            width: 250px;
            height: 250px;
            border-radius: 50%;
            overflow: hidden;
            margin-top: 20px;

            flex-shrink: 0;
            cursor: default;
            transition: all 0.3s ease;
            border: 4px solid #fff;
            box-shadow: 0 4px 16px rgba(0,0,0,0.2);
        }

        

        .pfp-pic {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 50%;
            background-color: #444;
            transition: filter 0.3s ease;
        }

        .pfp-container:hover .pfp-pic {
            filter: none;
        }

        .pic-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            border-radius: 50%;
            display: flex;
            justify-content: center;
            align-items: center;
            opacity: 0;
            transition: opacity 0.3s ease;
            background: rgba(0, 87, 184, 0.8);

        }

        .pfp-container:hover .pic-overlay {
            opacity: 0;
        }

        .background-image-container {
            position: relative;
            margin-top: 20px;
            width: 80%;
            height: 300px;
            border-radius: 20px;
            overflow: visible;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: default;
            transition: all 0.3s ease;
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
        }

        .background-image-container:hover {
            /* No hover effects */
        }

        

        

       

        .edit-icon {
            color: #fff;
            padding: 6px;
            border-radius: 50%;
            font-size: 1rem;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .profile-info-block {
            display: flex;
            flex-direction: column;
            position: absolute;
            top: 475px;
            left: 50%;
            transform: translateX(-50%);
            text-align: center;
        }

        .status-row {
            display: flex;
            align-items: flex-start;
            gap: 12px;
        }

        .status-cloud {
            position: absolute;
            top: -20px;
            right:-40px;
            background: #0b4dd1;
            padding: 6px 14px;
            border-radius: 999px;
            font-size: 0.9rem;
            color: white;
            
            align-items: center;
            z-index: 2;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .status-cloud:hover {
            background: #0a42b8 !important;
            transform: translateY(-2px);
        }

        .status-bubble1 {
            position: absolute;
            top:-7px;
            left: -12px;
            width: 12px;
            height: 12px;
            background: #1455d5;
            border-radius: 50%;
        }

        .status-bubble2 {
            position: absolute;
            top:-4px;
            left: -7px;
            width: 20px;
            height: 20px;
            background: #1455d5;
            border-radius: 50%;
        }

        .full-name {
            font-size: 2.2rem;
            font-weight: bold;
            color: rgb(58, 58, 58);
        }

        .friends-count {
            font-size: 1.2rem;
            color: #333333;
            margin-top: 4px;
            margin-left: 0;
        }

        .bio-text {
            font-size: 1rem;
            color: #666;
            margin-top: 8px;
            margin-bottom: 8px;
            max-width: 300px;
            margin-left: auto;
            margin-right: auto;
        }
        .divider{
            border: none;
            border-top: 1px solid #060606;
            margin: 20px auto;
            width: 80%;
            position: absolute;
            top: 550px;
            left: 50%;
            transform: translateX(-50%);
        }

        .saved-article {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 6px #0001;
            margin-bottom: 20px;
            border-left: 4px solid #0057b8;
            position: relative;
        }

        .saved-article-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 8px;
        }

        .saved-article h3 {
            color: #0057b8;
            font-size: 1.1rem;
            margin: 0;
            flex: 1;
        }

        .remove-article-btn {
            background: transparent;
            color: #333;
            border: none;
            border-radius: 50%;
            width: 25px;
            height: 25px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 16px;
            transition: background 0.2s ease;
            margin-left: 10px;
        }

        .remove-article-btn:hover {
            background: rgba(0,0,0,0.1);
        }

        .saved-article .meta {
            font-size: 0.85rem;
            color: #555;
            margin-bottom: 10px;
        }

        .saved-article .summary {
            font-size: 0.9rem;
            color: #333;
            margin-bottom: 10px;
        }

        .saved-article .saved-date {
            font-size: 0.8rem;
            color: #888;
            font-style: italic;
        }

        .saved-document {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 6px #0001;
            margin-bottom: 20px;
            border-left: 4px solid #28a745;
            position: relative;
        }

        .saved-document-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 8px;
        }

        .saved-document h3 {
            color: #0057b8;
            font-size: 1.1rem;
            margin: 0;
            flex: 1;
        }

        .remove-document-btn {
            background: transparent;
            color: #333;
            border: none;
            border-radius: 50%;
            width: 25px;
            height: 25px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 16px;
            transition: background 0.2s ease;
            margin-left: 10px;
        }

        .remove-document-btn:hover {
            background: rgba(0,0,0,0.1);
        }

        .saved-document .document-meta {
            font-size: 0.85rem;
            color: #555;
            margin-bottom: 10px;
        }

        .saved-document .document-content {
            font-size: 0.9rem;
            color: #333;
            margin-bottom: 10px;
            line-height: 1.4;
        }


        
        .sdbr2 {
            margin-top:65px;
            padding-top:80px;
            background-color:rgb(125, 125, 236);
            right:0%;
            width:299px;
            height: calc(100vh - 65px);
            z-index:10;
            position:absolute;
        }

        .online-container {
            background-color: orange;
            border-radius: 15px;
            padding: 10px;
        }

        .sdbr2 .online-user {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 10px;
            padding-left: 20px;
        }

        .sdbr2 .online-user i {
            font-size: 24px;
            color: #0057b8;
        }

        .sdbr2 .online-user span {
            font-size: 16px;
            color: #333;
        }

        .dark-mode .sdbr2 .online-container {
            background-color: #374151;
            color: #e2e8f0;
        }

        .dark-mode .sdbr2 h3 {
            color: #ffd700;
        }

        .dark-mode .sdbr2 .online-user span {
            color: #e2e8f0;
        }

        .dark-mode .sec-content {
            background-color: #181f2a;
            color: #e2e8f0;
        }

        .dark-mode .profile-header {
            background-color: #374151;
        }

        .dark-mode .article {
            background-color: #232f41;
            color: #e2e8f0;
        }

        .dark-mode .article p {
            color: #e2e8f0;
        }
        .main-content{
            position: relative;
            height: 120vh;
            width:67vw;
            margin-left:200px;
            margin-right:299px;
            margin-top:65px;
        }

        .main-content.expanded {
            margin-right: 0;
            width: calc(100vw - 200px);
        }
        .reset-size-btn {
            position: absolute;
            top: 3px;
            left: 3px;
            
            color: rgb(35, 35, 35);
            border: none;
            border-radius: 50%;
            width: 25px;
            height: 25px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.2);
            transition: background 0.3s ease;
            z-index: 10;
        }
        .reset-size-btn:hover {
            background: #003f8a;
        }
        .upld-content{
            display: flex;
            flex-wrap: wrap;
            padding-top:30px;
            padding-left:20px;
            padding-right:20px;
            gap: 20px;
            height:auto;
            width:auto;
            
            background-color: #a97e7ebd;
            
        }
        .upld-boxes{
            background-color: #f0f0f0;
            border-radius: 10px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            width: 206px;
            height: 250px;
            min-width: 150px;
            min-height: 200px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            cursor: pointer;
            resize: both;
            overflow: auto;
            position: relative;
        }
        .upld-boxes:hover{
            transform: translateY(-5px);
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.2);
        }

        .box-options-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            background: rgba(255, 255, 255, 0.8);
            border: none;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 16px;
            transition: background 0.2s ease;
            z-index: 10;
        }

        .box-options-btn:hover {
            background: rgba(255, 255, 255, 1);
        }

        .box-options-menu {
            position: absolute;
            top: 45px;
            right: 10px;
            background: white;
            border: 1px solid #ddd;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            z-index: 20;
            min-width: 120px;
            display: none;
        }

        .box-options-menu.show {
            display: block;
        }

        .box-options-menu div {
            padding: 10px 15px;
            cursor: pointer;
            transition: background 0.2s ease;
            font-size: 14px;
        }

        .box-options-menu div:hover {
            background: #f8f9fa;
        }

        .box-options-menu div:first-child {
            border-bottom: 1px solid #eee;
        }

        .delete-btn {
            position: absolute;
            top: 10px;
            left: 10px;
            background: #dc3545;
            color: white;
            border: none;
            border-radius: 50%;
            width: 25px;
            height: 25px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 14px;
            transition: background 0.2s ease;
            z-index: 10;
            display: none;
        }

        .delete-btn:hover {
            background: #c82333;
        }

        .upld-boxes.show-delete .delete-btn {
            display: flex;
        }
        .upld-boxes img{
            width: 100px;
            height: 100px;
            object-fit: contain;
            margin-bottom: 15px;
        }


        

        

        

        

        

        

        .top-row {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .article{
            margin-left:0;
            width: 80%;
            border-radius: 20px;
            display: inline-block;
        }

        .article p {
            color:white;
            margin-right:320px;
        }

        .main-navbar a{
            text-decoration: none;
        }

        .STI-logo {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .STI-logo span {
            font-size: 25px;
            color: #0057b8;
        }

        .STI-logo span .shrink {
            font-size: 18px;
            color: #0057b8;
        }

        .main-navbar a span{
            align-self: center;
        }

        .STI-logo a span{margin-bottom:20px;}

        /* Enhanced notification styles */
        @keyframes slideInRight {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        @keyframes slideOutRight {
            from { transform: translateX(0); opacity: 1; }
            to { transform: translateX(100%); opacity: 0; }
        }

        .profile-nav a.active {
            background-color: #0057b8 !important;
            color: white !important;
        }

        .profile-nav a.active:hover {
            background-color: #003f8a !important;
        }

        /* Drag and drop visual feedback */
        .profile-pic-container.drag-over {
            border: 3px dashed #0057b8 !important;
            background-color: rgba(0, 87, 184, 0.1) !important;
        }

        .toggle-sdbr2 {
            position: absolute;
            right: 299px;
            top: 50%;
            transform: translateY(-50%);
            width: 15px;
            height: 60px;
            background: #fff;
            border: 2px solid #0057b8;
            
            border-radius:15px 0px 0px 15px;
            display: flex;
            align-items: center;
            
            justify-content: center;
            cursor: pointer;
            font-size: 17px;
            color: #0057b8;
            transition: all 0.3s ease;
            z-index: 1;
        }

        .toggle-sdbr2:hover {
            background: #0057b8;
            color: #fff;
        }

        .dark-mode .toggle-sdbr2 {
            background: #232f41;
            border-color: #ffd700;
            color: #ffd700;
        }

        .dark-mode .toggle-sdbr2:hover {
            background: #ffd700;
            color: #232f41;
        }
    </style>
</head>
<body>
    <nav class="main-navbar" id="main-navbar">
        <div class="sti-logo">
            <a href="Homepage.html"><img src="STI Logo.png" alt="STI Logo" class="sti-logo"></a>
            <a href="Homepage.html"><span>ARCHIVES</span></a>
        </div>
        <div style="flex:1"></div>
        <div class="nav-center">
            <div class="nav-item">
                <a href="Homepage.html"><span class="nav-text">Home</span></a>
            </div>
            <div class="nav-item">
                <a href="library.html"><span class="nav-text">Library</span></a>
            </div>
            <div class="nav-item">
                <a href="#help"><span class="nav-text">About</span></a>
            </div>
        </div>
        <div class="navbar-right user-nav-fixed">
            <button class="dark-mode-toggle" id="darkModeToggle" aria-label="Toggle dark mode">
                <i class="fa fa-moon"></i>
            </button>
            <i class="fa fa-user-circle" id="userIcon" style="cursor:pointer;"></i>
        </div>
    </nav>

    <!-- Sidebar -->
    <div id="sidebar" class="sidebar">
        <div class="sidebar-content">
            
            <div class="user-info">
                <a href="pfp.html"><i class="fa fa-user-circle" id="user-Icon"></i></a>
                <div class="user-name">
                    <a href="pfp.html"><h3>UserName</h3></a>
                </div>
                <div class="account-switcher" >
                    <i class="fas fa-exchange-alt" title="Account Switcher"></i>
                </div>
            </div>
            
            <ul>
              
              
                <li><a href="library.html"><i class="fas fa-book"></i> Library</a></li>
                <li><a href="upload.php"><i class="fa-solid fa-upload"></i> <span class="text">My Uploads</span></a></li>
                <li style="margin-top: 10px;"><a href="myspace.html"><i class="fa-solid fa-feather-pointed"></i> <span class="text">My Space</span></a></li>
                <li style="margin-top: 10px;"><a href="#help"><i class="fa-solid fa-question-circle"></i> <span class="text">Help</span></a></li>
                <hr><li style="margin-top: 10px;"><a href="index.html"><i class="fa-solid fa-sign-out-alt"></i> <span class="text">Sign out</span></a></li>
            </ul>
        </div>
    </div>

    <section class="sdbr1" id="sdbr1">
        <button class="toggle-collapse" onclick="toggleSidebarCollapse()">‚ò∞</button>

        <ul class="sdbr1-menu">
            <li class="menu-header">Account</li>
            <li class="dropdown-item profile active" onclick="showSection('p-n-p', event)">Profile</li>
            <li class="dropdown-item friends" onclick="showSection('p-n-friends', event)">Friends</li>
            <li class="menu-header">MyLibrary</li>
            <li class="dropdown-item myuploads" onclick="showSection('p-n-m', event)">MyUploads</li>
            <li class="dropdown-item saved-articles" onclick="showSection('p-n-b', event)">Saved Articles</li>
            <li class="dropdown-item saved-docs" onclick="showSection('p-n-docs', event)">Saved Documents</li>
            <li class="menu-header">Settings</li>
            <li class="dropdown-item account-settings" onclick="showSection('p-n-account', event)">Account Settings</li>
            <li class="dropdown-item terms" onclick="showSection('p-n-terms', event)">Terms and Conditions</li>
            <li class="dropdown-item privacy" onclick="showSection('p-n-privacy', event)">Privacy Policy</li>
        </ul>

        <div class="collapsed-menu">
            <div class="collapsed-menu-item" title="Profile">
                üë§
                <div class="collapsed-dropdown">
                    <div onclick="showSection('p-n-p')">Profile</div>
                    <div onclick="showSection('p-n-friends')">Friends</div>
                </div>
            </div>
            <div class="collapsed-menu-item" title="My Library">
                üìö
                <div class="collapsed-dropdown">
                    <div onclick="showSection('p-n-m')">MyUploads</div>
                    <div onclick="showSection('p-n-b')">Saved Articles</div>
                    <div onclick="showSection('p-n-docs')">Saved Documents</div>
                </div>
            </div>
            <div class="collapsed-menu-item" title="Settings">
                ‚öôÔ∏è
                <div class="collapsed-dropdown">
                    <div onclick="showSection('p-n-account')">Account Settings</div>
                    <div onclick="showSection('p-n-terms')">Terms and Conditions</div>
                    <div onclick="showSection('p-n-privacy')">Privacy Policy</div>
                </div>
            </div>
        </div>

    </section>

    <div class="sdbr2">
        <div class="online-container">
            <h3>Online Users</h3>
            <div class="online-user">
                <i class="fa fa-user-circle"></i>
                <span>User 1</span>
            </div>
            <div class="online-user">
                <i class="fa fa-user-circle"></i>
                <span>User 2</span>
            </div>
            <div class="online-user">
                <i class="fa fa-user-circle"></i>
                <span>User 3</span>
            </div>
        </div>
        <div class="upload-container" style="margin-top: 20px; padding: 20px; border: 2px dashed #ccc; border-radius: 10px; text-align: center; cursor: pointer; background: #f9f9f9;">
            <i class="fas fa-cloud-upload-alt" style="font-size: 48px; color: #0057b8; margin-bottom: 10px;"></i>
            <p style="margin: 0; font-size: 18px; color: #333;">Drag & drop files here or click to upload</p>
            <input type="file" id="file-upload" accept="application/pdf,.doc,.docx" multiple style="display: none;">
        </div>
    </div>

    <div class="toggle-sdbr2" id="toggleSdbr2">
        <span>></span>
    </div>

    <section class="main-content">
        <div id="p-n-p" class="profile-section" style="display:none; text-align: center;">
            <div clas="pfp-p-container" style="display: flex; flex-direction: column; align-items: center; gap: 20px;">
                <div class="background-image-container" id="backgroundContainer" style="background-image: url('dbgc.png'); background-size: cover; background-position: center;">
                    
                    <input type="file" id="backgroundUpload" accept="image/*" onchange="changeBackground(event)" style="display: none;" />
                    <div class="pfp-container" style="position: absolute; top: 175px; left: 50%; transform: translateX(-50%);">
                        <label for="pfp-profileUpload">
                            <img src="Screenshot 2025-09-10 204105.png" alt="Profile" class="pfp-pic" id="pfpPic" />
                            <div class="pic-overlay">
                                <div class="edit-icon">üì∑</div>
                            </div>
                        </label>
                        <input type="file" id="profileUpload" accept="image/*" onchange="changeProfile(event)" style="display: none;" />
                    </div>
                </div>

                <div class="profile-info-block" style="text-align: center;">
                    <div class="full-name">Username</div>
                    <div class="friends-count">0 friends</div>
                    <div class="bio-text">This is my bio. Welcome to my profile!</div>
                    <div class="status-cloud" id="statusCloud">
                        <div class="status-bubble1"></div>
                        <div class="status-bubble2"></div>
                            + Add Status
                        </div>
                </div>
            </div>
        </div>
        <div id="p-n-m" class="profile-section" style="display:none;">
            <button class="reset-size-btn" title="Reset Box Sizes">
                <i class="fas fa-undo"></i>
            </button>
            <div class="upld-content">
                <div class="upld-boxes">
                    <button class="box-options-btn" onclick="toggleBoxOptions(this)">‚ãÆ</button>
                    <div class="box-options-menu">
                        <div onclick="editBox(this)">‚úèÔ∏è Edit</div>
                        <div onclick="deleteBox(this)">üóëÔ∏è Delete</div>
                    </div>
                    <button class="delete-btn" onclick="confirmDelete(this)">√ó</button>
                    <img src="paper2.png">
                    <div class="upld-dscrpt">Description</div>
                </div>
                <div class="upld-boxes">
                    <button class="box-options-btn" onclick="toggleBoxOptions(this)">‚ãÆ</button>
                    <div class="box-options-menu">
                        <div onclick="editBox(this)">‚úèÔ∏è Edit</div>
                        <div onclick="deleteBox(this)">üóëÔ∏è Delete</div>
                    </div>
                    <button class="delete-btn" onclick="confirmDelete(this)">√ó</button>
                    <img src="paper2.png">
                    <div class="upld-dscrpt">Description</div>
                </div>
                <div class="upld-boxes">
                    <button class="box-options-btn" onclick="toggleBoxOptions(this)">‚ãÆ</button>
                    <div class="box-options-menu">
                        <div onclick="editBox(this)">‚úèÔ∏è Edit</div>
                        <div onclick="deleteBox(this)">üóëÔ∏è Delete</div>
                    </div>
                    <button class="delete-btn" onclick="confirmDelete(this)">√ó</button>
                    <img src="paper2.png">
                    <div class="upld-dscrpt">Description</div>
                </div>
                <div class="upld-boxes">
                    <button class="box-options-btn" onclick="toggleBoxOptions(this)">‚ãÆ</button>
                    <div class="box-options-menu">
                        <div onclick="editBox(this)">‚úèÔ∏è Edit</div>
                        <div onclick="deleteBox(this)">üóëÔ∏è Delete</div>
                    </div>
                    <button class="delete-btn" onclick="confirmDelete(this)">√ó</button>
                    <img src="paper2.png">
                    <div class="upld-dscrpt">Description</div>
                </div>
            </div>
        </div>
        <div id="p-n-b" class="profile-section" style="display:none;">
            
            <div id="saved-articles-container">
                <!-- Saved articles will be loaded here -->
            </div>
        </div>
        <div id="p-n-f" class="profile-section" style="display:none;">
            <h2>Friends</h2>
            <p>Your friends list and connections.</p>
            <!-- Add more content as needed -->
        </div>
        <div id="p-n-s" class="profile-section" style="display:none;">
            <h2>Settings</h2>
            <p>Account settings and preferences.</p>
            <!-- Add more content as needed -->
        </div>
        <div id="p-n-friends" class="profile-section" style="display:none;">
            
            <div class="friends-list">
                <div class="friend-item">
                    <div class="friend-avatar">
                        <i class="fas fa-user-circle"></i>
                    </div>
                    <div class="friend-name">John Doe</div>
                </div>
                <div class="friend-item">
                    <div class="friend-avatar">
                        <i class="fas fa-user-circle"></i>
                    </div>
                    <div class="friend-name">Jane Smith</div>
                </div>
                <div class="friend-item">
                    <div class="friend-avatar">
                        <i class="fas fa-user-circle"></i>
                    </div>
                    <div class="friend-name">Mike Johnson</div>
                </div>
                <div class="friend-item">
                    <div class="friend-avatar">
                        <i class="fas fa-user-circle"></i>
                    </div>
                    <div class="friend-name">Sarah Wilson</div>
                </div>
            </div>
        </div>
        <div id="p-n-docs" class="profile-section" style="display:none;">
            <div id="saved-documents-container">
                <!-- Saved documents will be loaded here -->
            </div>
        </div>
        
            
        <div id="p-n-account" class="profile-section" style="display:none;">
            <!-- Profile Picture Section -->
            <div class="account-section">
                <h3>Profile Picture</h3>
                <div class="mini-profile-container">
                    <div class="mini-background-image-container">
                        <div class="mini-pfp-container">
                            <img src="Screenshot 2025-09-10 204105.png" alt="Profile" class="mini-pfp-pic" id="miniPfpPic" />
                        </div>
                    </div>
                    <div class="mini-profile-buttons">
                        <button class="mini-upload-btn" onclick="document.getElementById('miniCoverUpload').click()">Upload Cover Photo</button>
                        <button class="mini-upload-btn" onclick="document.getElementById('miniProfileUpload').click()">Upload Profile Pic</button>
                        <button class="mini-delete-btn">Delete</button>
                        <input type="file" id="miniCoverUpload" accept="image/*" onchange="changeMiniCover(event)" style="display: none;" />
                        <input type="file" id="miniProfileUpload" accept="image/*" onchange="changeMiniProfile(event)" style="display: none;" />
                    </div>
                </div>

                <!-- Full Name Section -->
                <div class="name-section">
                    <div class="name-row">
                        <div class="name-input-group">
                            <label for="firstName">First Name</label>
                            <input type="text" id="firstName" value="John" oninput="updateNameAuto()" />
                        </div>
                        <div class="name-input-group">
                            <label for="lastName">Last Name</label>
                            <input type="text" id="lastName" value="Doe" oninput="updateNameAuto()" />
                        </div>
                    </div>
                </div>
            </div>

            <!-- Email Section -->
            <div class="account-section">
                <h3>Email</h3>
                <div class="email-section">
                    <input type="email" id="userEmailInput" value="user@example.com" readonly />
                    <button class="update-email-btn" onclick="updateEmail()">
                        <i class="fas fa-plus"></i> Update Email
                    </button>
                </div>
            </div>

            <!-- Password Section -->
            <div class="account-section">
                <h3>Password</h3>
                <div class="password-section">
                    <div class="password-input-container">
                        <i class="fas fa-lock password-icon"></i>
                        <input type="password" id="currentPassword" placeholder="Current password" class="password-input" />
                        <i class="fas fa-eye password-toggle" onclick="togglePasswordVisibility('currentPassword')"></i>
                    </div>
                    <div class="password-input-container">
                        <i class="fas fa-lock password-icon"></i>
                        <input type="password" id="newPassword" placeholder="New password" class="password-input" />
                        <i class="fas fa-eye password-toggle" onclick="togglePasswordVisibility('newPassword')"></i>
                    </div>
                    <div class="password-input-container">
                        <i class="fas fa-lock password-icon"></i>
                        <input type="password" id="confirmPassword" placeholder="Confirm new password" class="password-input" />
                        <i class="fas fa-eye password-toggle" onclick="togglePasswordVisibility('confirmPassword')"></i>
                    </div>
                    <button class="update-password-btn">Update Password</button>
                </div>
            </div>
        </div>
        <div id="p-n-terms" class="profile-section" style="display:none;">
            <h2>Terms and Conditions</h2>

            <!-- Terms and Conditions Section -->
            <div class="account-section">
                <div class="terms-section" style="padding: 15px; background: #f8f9fa; border-radius: 8px; border: 1px solid #e9ecef;">

                    <h4 style="margin-top: 15px; margin-bottom: 8px; color: #0057b8;">1. Acceptance of Terms</h4>
                    <p style="margin: 0 0 10px 0; color: #555;">By accessing and using STI Archives, you agree to comply with these Terms and Conditions. If you do not agree, please discontinue use of the service.</p>

                    <h4 style="margin-top: 15px; margin-bottom: 8px; color: #0057b8;">2. User Accounts</h4>
                    <p style="margin: 0 0 10px 0; color: #555;">Users must provide accurate information (such as full name and Registration Assessment Form). You are responsible for maintaining the confidentiality of your account and activities under it.</p>

                    <h4 style="margin-top: 15px; margin-bottom: 8px; color: #0057b8;">3. Content Usage</h4>
                    <p style="margin: 0 0 10px 0; color: #555;">All research papers, capstone projects, and other content in STI Archives are protected under copyright and academic integrity standards. Unauthorized downloading, copying, or distribution without permission is strictly prohibited and may result in penalties.</p>

                    <h4 style="margin-top: 15px; margin-bottom: 8px; color: #0057b8;">4. Prohibited Activities</h4>
                    <p style="margin: 0 0 10px 0; color: #555;">Uploading inappropriate, offensive, or non-academic content (e.g., unrelated images or PDFs).<br>Using another person's work without proper authorization.<br>Attempting to bypass security measures or misuse the website.<br>Violations may result in suspension of access for up to 1 month or permanent banning for repeated offenses.</p>

                    <h4 style="margin-top: 15px; margin-bottom: 8px; color: #0057b8;">5. Privacy</h4>
                    <p style="margin: 0 0 10px 0; color: #555;">Your personal information, including full name and RAF, is collected for verification and record purposes. For details, please review our Privacy Policy.</p>

                    <h4 style="margin-top: 15px; margin-bottom: 8px; color: #0057b8;">6. Enforcement and Penalties</h4>
                    <p style="margin: 0 0 10px 0; color: #555;">Users who take research files without authorization will face disciplinary actions, which may include temporary suspension, account restriction, or referral to STI College administration for further action.</p>

                    <h4 style="margin-top: 15px; margin-bottom: 8px; color: #0057b8;">7. Termination</h4>
                    <p style="margin: 0 0 10px 0; color: #555;">STI Archives reserves the right to suspend or terminate any account immediately, without prior notice, for violation of these terms.</p>

                    <h4 style="margin-top: 15px; margin-bottom: 8px; color: #0057b8;">8. Disclaimer</h4>
                    <p style="margin: 0; color: #555;">STI Archives is provided on an "as is" basis. We make no warranties regarding uninterrupted access, completeness of content, or fitness for a particular purpose.</p>
                </div>
            </div>
        </div>

        <div id="p-n-privacy" class="profile-section" style="display:none;">
            <h2>Privacy Policy</h2>

            <!-- Privacy Policy Section -->
            <div class="account-section">
                <div class="privacy-section" style="padding: 15px; background: #f8f9fa; border-radius: 8px; border: 1px solid #e9ecef;">

                    <h4 style="margin-top: 15px; margin-bottom: 8px; color: #0057b8;">1. Information We Collect</h4>
                    <p style="margin: 0 0 10px 0; color: #555;">We collect the information you provide directly to us, such as when you create an account, upload academic work, or contact us for assistance. This may include your full name and Registration Assessment Form (RAF) for verification purposes.</p>

                    <h4 style="margin-top: 15px; margin-bottom: 8px; color: #0057b8;">2. How We Use Your Information</h4>
                    <p style="margin: 0 0 10px 0; color: #555;">The information we collect is used to verify user identity, manage and improve our services, process submissions, and communicate with you regarding your account and activities within STI Archives.</p>

                    <h4 style="margin-top: 15px; margin-bottom: 8px; color: #0057b8;">3. Information Sharing</h4>
                    <p style="margin: 0 0 10px 0; color: #555;">We do not sell, trade, or share your personal information with outside parties without your consent, except when required by school administration or applicable law.</p>

                    <h4 style="margin-top: 15px; margin-bottom: 8px; color: #0057b8;">4. Your Rights</h4>
                    <p style="margin: 0 0 10px 0; color: #555;">You have the right to request access, correction, or deletion of your personal information at any time. Please contact STI Archives support for such requests.</p>

                    <h4 style="margin-top: 15px; margin-bottom: 8px; color: #0057b8;">5. Changes to This Policy</h4>
                    <p style="margin: 0 0 10px 0; color: #555;">We may update this Privacy Policy from time to time. Any changes will be posted on this page, and continued use of the website means acceptance of the updated policy.</p>

                    <h4 style="margin-top: 15px; margin-bottom: 8px; color: #0057b8;">6. Contact Us</h4>
                    <p style="margin: 0; color: #555;">If you have any questions or concerns about this Privacy Policy, please reach out to us through the STI Archives support system.</p>
                </div>
            </div>
        </div>
    </section>

    <script>
        
        // Profile Picture Upload Functionality
        function changeProfile(event) {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const profilePic = document.getElementById('pfpPic');
                    profilePic.src = e.target.result;

                    // Save to localStorage for persistence
                    localStorage.setItem('profilePicture', e.target.result);

                    // Show success notification
                    showNotification('Profile picture updated successfully!', 'success');
                };
                reader.readAsDataURL(file);
            }
        }

        // Background Image Upload Functionality
        function changeBackground(event) {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const backgroundContainer = document.getElementById('backgroundContainer');
                    backgroundContainer.style.backgroundImage = `url(${e.target.result})`;
                    backgroundContainer.style.backgroundSize = 'cover';
                    backgroundContainer.style.backgroundPosition = 'center';

                    // Save to localStorage for persistence
                    localStorage.setItem('backgroundImage', e.target.result);

                    // Show success notification
                    showNotification('Background image updated successfully!', 'success');
                };
                reader.readAsDataURL(file);
            }
        }


        // Load saved images on page load
        function loadSavedImages() {
            const savedProfilePic = localStorage.getItem('profilePicture');
            const savedBackground = localStorage.getItem('backgroundImage');

            if (savedProfilePic) {
                document.getElementById('pfpPic').src = savedProfilePic;
            }

            if (savedBackground) {
                const backgroundContainer = document.getElementById('backgroundContainer');
                backgroundContainer.style.backgroundImage = `url(${savedBackground})`;
                backgroundContainer.style.backgroundSize = 'cover';
                backgroundContainer.style.backgroundPosition = 'center';
            }
        }

        // Enhanced profile picture positioning and effects
        function initializeProfileFeatures() {
            const profilePicContainer = document.querySelector('.pfp-container');
            const profilePic = document.getElementById('pfpPic');

            // Remove click to upload functionality
            // profilePicContainer.addEventListener('click', function() {
            //     document.getElementById('profileUpload').click();
            // });

            // Add drag and drop functionality
            profilePicContainer.addEventListener('dragover', function(e) {
                e.preventDefault();
                profilePicContainer.classList.add('drag-over');
            });

            profilePicContainer.addEventListener('dragleave', function(e) {
                e.preventDefault();
                profilePicContainer.classList.remove('drag-over');
            });

            profilePicContainer.addEventListener('drop', function(e) {
                e.preventDefault();
                profilePicContainer.classList.remove('drag-over');

                const file = e.dataTransfer.files[0];
                if (file && file.type.startsWith('image/')) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        profilePic.src = e.target.result;
                        localStorage.setItem('profilePicture', e.target.result);
                        showNotification('Profile picture updated successfully!', 'success');
                    };
                    reader.readAsDataURL(file);
                } else {
                    showNotification('Please drop a valid image file', 'error');
                }
            });

            // Add zoom functionality on double click
            let zoomLevel = 1;
            profilePicContainer.addEventListener('dblclick', function() {
                zoomLevel = zoomLevel === 1 ? 1.5 : 1;
                profilePic.style.transform = `scale(${zoomLevel})`;
                profilePic.style.transition = 'transform 0.3s ease';
            });

            // Add rotation functionality
            let rotation = 0;
            document.addEventListener('keydown', function(e) {
                if (e.ctrlKey && e.key === 'r') {
                    e.preventDefault();
                    rotation += 90;
                    profilePic.style.transform = `rotate(${rotation}deg)`;
                }
            });
        }

        // Notification system
        function showNotification(message, type = 'info') {
            // Remove existing notifications
            const existingNotifications = document.querySelectorAll('.notification');
            existingNotifications.forEach(notification => notification.remove());

            const notification = document.createElement('div');
            notification.className = `notification notification-${type}`;
            notification.innerHTML = `
                <div class="notification-content">
                    <span class="notification-message">${message}</span>
                    <button class="notification-close" onclick="this.parentElement.parentElement.remove()">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            `;

            // Add notification styles
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: ${type === 'success' ? '#28a745' : type === 'error' ? '#dc3545' : '#0057b8'};
                color: white;
                padding: 15px 20px;
                border-radius: 8px;
                box-shadow: 0 4px 12px rgba(0,0,0,0.15);
                z-index: 1000;
                animation: slideInRight 0.3s ease;
                animation-fill-mode: forwards;
            `;
        
            // Style the close button
            const closeBtn = notification.querySelector('.notification-close');
            if (closeBtn) {
                closeBtn.style.cssText = `
                    background: none;
                    border: none;
                    color: white;
                    cursor: pointer;
                    font-size: 16px;
                    padding: 0;
                    margin-left: 10px;
                `;
            }

            document.body.appendChild(notification);

            // Auto remove after 3 seconds
            setTimeout(() => {
                if (notification.parentElement) {
                    notification.style.animation = 'slideOutRight 0.3s ease';
                    notification.style.animationFillMode = 'forwards';
                    setTimeout(() => notification.remove(), 300);
                }
            }, 3000);
        }

        // Status update functionality
        function initializeStatusFeatures() {
            const statusCloud = document.getElementById('statusCloud');

            statusCloud.addEventListener('click', function() {
                showStatusModal();
            });

            // Load saved status
            const savedStatus = localStorage.getItem('userStatus');
            if (savedStatus) {
                updateStatusDisplay(savedStatus);
            }
        }

        // Show status modal
        function showStatusModal() {
            const modal = document.createElement('div');
            modal.className = 'status-modal';
            modal.innerHTML = `
                <div class="status-modal-content">
                    <div class="status-modal-header">
                        <h3>Update Status</h3>
                        <button class="status-modal-close" onclick="closeStatusModal()">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    <div class="status-modal-body">
                        <textarea id="statusInput" placeholder="What's on your mind?" rows="4"></textarea>
                        <div class="status-options">
                            <div class="status-emoji">
                                <span>üòä</span><span>üò¢</span><span>üéâ</span><span>üíº</span><span>‚úàÔ∏è</span><span>üçï</span>
                            </div>
                            <div class="status-privacy">
                                <select id="statusPrivacy">
                                    <option value="public">üåç Public</option>
                                    <option value="friends">üë• Friends</option>
                                    <option value="private">üîí Only Me</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    <div class="status-modal-footer">
                        <button class="status-btn cancel" onclick="closeStatusModal()">Cancel</button>
                        <button class="status-btn save" onclick="saveStatus()">Save Status</button>
                    </div>
                </div>
            `;

            // Add modal styles
            modal.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0, 0, 0, 0.5);
                display: flex;
                justify-content: center;
                align-items: center;
                z-index: 1000;
                animation: fadeIn 0.3s ease;
                overflow: hidden;
            `;

            const style = document.createElement('style');
            style.textContent = `
                @keyframes fadeIn {
                    from { opacity: 0; }
                    to { opacity: 1; }
                }

                .status-modal-content {
                    background: white;
                    border-radius: 12px;
                    width: 90%;
                    max-width: 500px;
                    box-shadow: 0 10px 30px rgba(0,0,0,0.3);
                    animation: slideIn 0.3s ease;
                }

                @keyframes slideIn {
                    from { transform: translateY(-50px); opacity: 0; }
                    to { transform: translateY(0); opacity: 1; }
                }

                .status-modal-header {
                    display: flex;
                    justify-content: space-between;
                    align-items: center;
                    padding: 20px;
                    border-bottom: 1px solid #eee;
                }

                .status-modal-header h3 {
                    margin: 0;
                    color: #0057b8;
                }

                .status-modal-close {
                    background: none;
                    border: none;
                    font-size: 20px;
                    cursor: pointer;
                    color: #666;
                }

                .status-modal-body {
                    padding: 20px;
                }

                #statusInput {
                    width: 100%;
                    border: 2px solid #ddd;
                    border-radius: 8px;
                    padding: 12px;
                    font-size: 16px;
                    resize: vertical;
                    font-family: inherit;
                }

                #statusInput:focus {
                    outline: none;
                    border-color: #0057b8;
                }

                .status-options {
                    margin-top: 15px;
                    display: flex;
                    justify-content: space-between;
                    align-items: center;
                }

                .status-emoji span {
                    cursor: pointer;
                    font-size: 20px;
                    margin-right: 8px;
                    transition: transform 0.2s ease;
                }

                .status-emoji span:hover {
                    transform: scale(1.2);
                }

                .status-privacy select {
                    padding: 8px 12px;
                    border: 1px solid #ddd;
                    border-radius: 6px;
                    background: white;
                }

                .status-modal-footer {
                    padding: 20px;
                    border-top: 1px solid #eee;
                    display: flex;
                    justify-content: flex-end;
                    gap: 10px;
                }

                .status-btn {
                    padding: 10px 20px;
                    border: none;
                    border-radius: 6px;
                    cursor: pointer;
                    font-weight: 500;
                    transition: background 0.3s ease;
                }

                .status-btn.cancel {
                    background: #f0f0f0;
                    color: #666;
                }

                .status-btn.cancel:hover {
                    background: #e0e0e0;
                }

                .status-btn.save {
                    background: #0057b8;
                    color: white;
                }

                .status-btn.save:hover {
                    background: #003f8a;
                }

                .dark-mode .status-modal-content {
                    background: #232f41;
                    color: #e2e8f0;
                }

                .dark-mode .status-modal-header {
                    border-bottom-color: #374151;
                }

                .dark-mode #statusInput {
                    background: #374151;
                    border-color: #4b5563;
                    color: #e2e8f0;
                }

                .dark-mode .status-modal-footer {
                    border-top-color: #374151;
                }

                .dark-mode .status-btn.cancel {
                    background: #374151;
                    color: #e2e8f0;
                }

                .dark-mode .status-btn.cancel:hover {
                    background: #4b5563;
                }
            `;

            document.head.appendChild(style);
            document.body.appendChild(modal);

            // Load existing status
            const savedStatus = localStorage.getItem('userStatus');
            if (savedStatus) {
                document.getElementById('statusInput').value = savedStatus;
            }

            // Add emoji click functionality
            const emojiSpans = modal.querySelectorAll('.status-emoji span');
            emojiSpans.forEach(emoji => {
                emoji.addEventListener('click', function() {
                    const input = document.getElementById('statusInput');
                    input.value += this.textContent + ' ';
                    input.focus();
                });
            });
        }

        // Close status modal
        function closeStatusModal() {
            const modal = document.querySelector('.status-modal');
            if (modal) {
                modal.style.animation = 'fadeOut 0.3s ease';
                setTimeout(() => modal.remove(), 300);
            }
        }

        // Save status
        function saveStatus() {
            const input = document.getElementById('statusInput');
            const privacy = document.getElementById('statusPrivacy');
            const status = input.value.trim();

            if (status) {
                const statusData = {
                    text: status,
                    privacy: privacy.value,
                    timestamp: new Date().toISOString()
                };

                localStorage.setItem('userStatus', status);
                localStorage.setItem('statusData', JSON.stringify(statusData));

                updateStatusDisplay(status);
                closeStatusModal();
                showNotification('Status updated successfully!', 'success');
            } else {
                showNotification('Please enter a status message', 'error');
            }
        }

        // Update status display
        function updateStatusDisplay(status) {
            const statusCloud = document.getElementById('statusCloud');
            const statusText = statusCloud.lastChild;

            if (statusText.nodeType === Node.TEXT_NODE) {
                statusText.textContent = status;
            } else {
                statusCloud.innerHTML = `
                    <div class="status-bubble1"></div>
                    <div class="status-bubble2"></div>
                    ${status}
                `;
            }
        }

        // Profile navigation functionality
        function showSection(id, event) {
            // Remove active class from all menu items
            const menuItems = document.querySelectorAll('.sdbr1-menu li');
            menuItems.forEach(item => item.classList.remove('active'));

            // Hide all sections
            const sections = document.querySelectorAll('.profile-section');
            sections.forEach(section => section.style.display = 'none');

            // Show target section
            const targetSection = document.getElementById(id);
            if (targetSection) {
                targetSection.style.display = 'block';

                // Load saved articles if showing saved articles section
                if (id === 'p-n-b') {
                    loadSavedArticles();
                }

                // Load saved documents if showing saved documents section
                if (id === 'p-n-docs') {
                    loadSavedDocuments();
                }
            }

            // Add active class to clicked menu item
            if (event && event.target) {
                const clickedItem = event.target.closest('li');
                if (clickedItem) {
                    clickedItem.classList.add('active');
                }
            }
        }

        // Load saved articles from localStorage
        function loadSavedArticles() {
            const container = document.getElementById('saved-articles-container');
            if (!container) return;

            container.innerHTML = '';

            // Get saved articles from localStorage
            const savedArticles = JSON.parse(localStorage.getItem('savedArticles')) || [];

            if (savedArticles.length === 0) {
                container.innerHTML = '<p>No saved articles yet.</p>';
                return;
            }

            savedArticles.forEach((article, index) => {
                const articleDiv = document.createElement('div');
                articleDiv.className = 'saved-article';

                // Determine border color based on category (matching library.html)
                let borderColor = '#0057b8'; // default
                if (article.category === 'research') {
                    borderColor = '#f4c430';
                } else if (article.category === 'capstone') {
                    borderColor = '#0057b8';
                }

                articleDiv.style.borderLeft = `4px solid ${borderColor}`;

                articleDiv.innerHTML = `
                    <div class="saved-article-header">
                        <h3>${article.title}</h3>
                        <button class="remove-article-btn" onclick="removeSavedArticle(${index})" title="Remove from saved">√ó</button>
                    </div>
                    <div class="meta">${article.meta}</div>
                    <div class="summary">${article.summary}</div>
                    <div class="saved-date">Saved on: ${new Date(article.savedDate).toLocaleDateString()}</div>
                `;
                container.appendChild(articleDiv);
            });
        }

        // Load saved documents from localStorage
        function loadSavedDocuments() {
            const container = document.getElementById('saved-documents-container');
            if (!container) return;

            container.innerHTML = '';

            // Get documents from both sources
            const savedDocuments = JSON.parse(localStorage.getItem('savedDocuments')) || [];
            const pfpDocuments = JSON.parse(localStorage.getItem('pfpDocuments')) || [];

            // Combine and remove duplicates based on ID
            const allDocuments = [...savedDocuments, ...pfpDocuments];
            const uniqueDocuments = allDocuments.filter((doc, index, self) =>
                index === self.findIndex(d => d.id === doc.id)
            );

            console.log('Loading saved documents:', uniqueDocuments); // Debug log

            if (uniqueDocuments.length === 0) {
                container.innerHTML = '<p>No saved documents yet.</p>';
                return;
            }

            uniqueDocuments.forEach((doc, index) => {
                const docDiv = document.createElement('div');
                docDiv.className = 'saved-document';
                docDiv.onclick = () => viewDocumentModal(doc);

                const sourceIndicator = doc.sentFromMyspace ? ' <small style="color: #28a745;">(From MySpace)</small>' : '';

                docDiv.innerHTML = `
                    <div class="saved-document-header">
                        <h3>${doc.title}${sourceIndicator}</h3>
                        <button class="remove-document-btn" onclick="removeSavedDocument(${doc.id}); event.stopPropagation();" title="Remove from saved">√ó</button>
                    </div>
                    <div class="document-meta">Author: ${doc.author || 'Unknown'} | Created: ${new Date(doc.date).toLocaleDateString()}</div>
                    <div class="document-content">${doc.content.substring(0, 200)}${doc.content.length > 200 ? '...' : ''}</div>
                `;
                container.appendChild(docDiv);
            });
        }

        // Listen for document save events from myspace.html
        window.addEventListener('storage', function(e) {
            if (e.key === 'documentUpdateTrigger' || e.key === 'savedDocuments' || e.key === 'pfpDocumentUpdate') {
                // Reload documents when myspace.html saves something
                const currentSection = document.querySelector('.profile-section[style*="display: block"]');
                if (currentSection && currentSection.id === 'p-n-docs') {
                    loadSavedDocuments();
                }
            }
        });

        // Listen for messages from myspace.html
        window.addEventListener('message', function(e) {
            if (e.data.type === 'documentSaved') {
                // Reload documents when myspace.html saves something
                const currentSection = document.querySelector('.profile-section[style*="display: block"]');
                if (currentSection && currentSection.id === 'p-n-docs') {
                    loadSavedDocuments();
                }
            }
        });

        // View document in modal
        function viewDocumentModal(doc) {
            // Create modal
            const modal = document.createElement('div');
            modal.className = 'document-view-modal';
            modal.innerHTML = `
                <div class="document-view-modal-content">
                    <div class="document-view-modal-header">
                        <h2>${doc.title}</h2>
                        <button class="document-view-modal-close" onclick="closeDocumentModal()">&times;</button>
                    </div>
                    <div class="document-view-modal-body">
                        <div class="document-meta-info">
                            <p><strong>Author:</strong> ${doc.author || 'Unknown'}</p>
                            <p><strong>Created:</strong> ${new Date(doc.date).toLocaleDateString()}</p>
                            ${doc.sentFromMyspace ? '<p><strong>Source:</strong> <span style="color: #28a745;">Sent from MySpace</span></p>' : ''}
                        </div>
                        <div class="document-full-content">${doc.content}</div>
                    </div>
                </div>
            `;

            // Add modal styles
            modal.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0,0,0,0.7);
                display: flex;
                justify-content: center;
                align-items: center;
                z-index: 10000;
            `;

            const style = document.createElement('style');
            style.textContent = `
                .document-view-modal-content {
                    background: white;
                    border-radius: 12px;
                    width: 90%;
                    max-width: 800px;
                    max-height: 90vh;
                    box-shadow: 0 10px 30px rgba(0,0,0,0.3);
                    display: flex;
                    flex-direction: column;
                }

                .document-view-modal-header {
                    display: flex;
                    justify-content: space-between;
                    align-items: center;
                    padding: 20px;
                    border-bottom: 1px solid #eee;
                }

                .document-view-modal-header h2 {
                    margin: 0;
                    color: #0057b8;
                    font-size: 1.5rem;
                }

                .document-view-modal-close {
                    background: none;
                    border: none;
                    font-size: 28px;
                    cursor: pointer;
                    color: #666;
                    padding: 0;
                    width: 30px;
                    height: 30px;
                    display: flex;
                    align-items: center;
                    justify-content: center;
                }

                .document-view-modal-body {
                    padding: 20px;
                    overflow-y: auto;
                    flex: 1;
                }

                .document-meta-info {
                    margin-bottom: 20px;
                    padding: 15px;
                    background: #f8f9fa;
                    border-radius: 8px;
                }

                .document-meta-info p {
                    margin: 5px 0;
                    color: #555;
                }

                .document-full-content {
                    background: #fff;
                    border: 1px solid #ddd;
                    border-radius: 0;
                    padding: 1in;
                    width: 8.5in;
                    min-height: 11in;
                    max-width: 100%;
                    margin: 20px auto;
                    line-height: 1.15;
                    color: #000;
                    white-space: pre-wrap;
                    word-wrap: break-word;
                    font-family: 'Times New Roman', serif;
                    font-size: 12pt;
                    box-shadow: 0 0 10px rgba(0,0,0,0.1);
                    position: relative;
                }

                .document-full-content::before {
                    content: '';
                    position: absolute;
                    top: 0;
                    left: 0;
                    right: 0;
                    height: 1in;
                    background: linear-gradient(to bottom, rgba(255,255,255,0.8) 0%, rgba(255,255,255,0) 100%);
                    pointer-events: none;
                }

                .dark-mode .document-view-modal-content {
                    background: #232f41;
                    color: #e2e8f0;
                }

                .dark-mode .document-view-modal-header {
                    border-bottom-color: #374151;
                }

                .dark-mode .document-meta-info {
                    background: #374151;
                }

                .dark-mode .document-full-content {
                    background: #2d2d2d;
                    color: #e2e8f0;
                    border-color: #555;
                    box-shadow: 0 0 15px rgba(0,0,0,0.3);
                }

                .dark-mode .document-full-content::before {
                    background: linear-gradient(to bottom, rgba(45,45,45,0.8) 0%, rgba(45,45,45,0) 100%);
                }
            `;

            document.head.appendChild(style);
            document.body.appendChild(modal);

            // Close modal when clicking backdrop
            modal.addEventListener('click', (e) => {
                if (e.target === modal) {
                    closeDocumentModal();
                }
            });
        }

        // Close document view modal
        function closeDocumentModal() {
            const modal = document.querySelector('.document-view-modal');
            if (modal) {
                modal.remove();
            }
        }

        // Remove saved document
        function removeSavedDocument(docId) {
            if (confirm('Are you sure you want to remove this saved document?')) {
                let savedDocuments = JSON.parse(localStorage.getItem('savedDocuments')) || [];
                let pfpDocuments = JSON.parse(localStorage.getItem('pfpDocuments')) || [];

                // Remove from both storage locations
                savedDocuments = savedDocuments.filter(doc => doc.id !== docId);
                pfpDocuments = pfpDocuments.filter(doc => doc.id !== docId);

                localStorage.setItem('savedDocuments', JSON.stringify(savedDocuments));
                localStorage.setItem('pfpDocuments', JSON.stringify(pfpDocuments));

                loadSavedDocuments(); // Reload the list
                showNotification('Document removed from saved documents!', 'success');
            }
        }

        // Remove saved article
        function removeSavedArticle(index) {
            if (confirm('Are you sure you want to remove this saved article?')) {
                let savedArticles = JSON.parse(localStorage.getItem('savedArticles')) || [];
                savedArticles.splice(index, 1);
                localStorage.setItem('savedArticles', JSON.stringify(savedArticles));
                loadSavedArticles(); // Reload the list
                showNotification('Article removed from saved articles!', 'success');
            }
        }

        function toggleDropdown(el) {
            const li = el.parentElement;
            li.classList.toggle('open');
        }

        function toggleSidebarCollapse() {
            const sidebar = document.getElementById('sdbr1');
            const mainContent = document.querySelector('.main-content');
            const toggleBtn = document.querySelector('.toggle-collapse');
            const sdbr2 = document.querySelector('.sdbr2');

            if (sidebar.classList.contains('collapsed')) {
                sidebar.classList.remove('collapsed');
                if (sdbr2.style.display === 'none') {
                    mainContent.style.width = 'calc(100vw - 200px)';
                    mainContent.style.marginLeft = '200px';
                    mainContent.style.marginRight = '0';
                } else {
                    mainContent.style.width = '67vw';
                    mainContent.style.marginLeft = '200px';
                    mainContent.style.marginRight = '299px';
                }
                toggleBtn.textContent = '‚ò∞';
            } else {
                sidebar.classList.add('collapsed');
                if (sdbr2.style.display === 'none') {
                    mainContent.style.width = 'calc(100vw - 50px)';
                    mainContent.style.marginLeft = '50px';
                    mainContent.style.marginRight = '0';
                } else {
                    mainContent.style.width = 'calc(100vw - 349px)';
                    mainContent.style.marginLeft = '50px';
                    mainContent.style.marginRight = '299px';
                }
                toggleBtn.textContent = '‚ò∞';
            }
        }


        // Dark mode functionality
        const darkModeToggle = document.getElementById('darkModeToggle');
        const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
        const savedMode = localStorage.getItem('darkMode');

        function setDarkMode(on) {
            document.body.classList.toggle('dark-mode', on);
            darkModeToggle.innerHTML = on
                ? '<i class="fa fa-sun"></i>'
                : '<i class="fa fa-moon"></i>';
            localStorage.setItem('darkMode', on ? 'on' : 'off');
        }

        setDarkMode(savedMode === 'on' || (savedMode === null && prefersDark));
        darkModeToggle.onclick = () => {
            setDarkMode(!document.body.classList.contains('dark-mode'));
        };

        // Load saved name and email on page load
        function loadSavedName() {
            const savedFirstName = localStorage.getItem('userFirstName');
            const savedLastName = localStorage.getItem('userLastName');
            const savedEmail = localStorage.getItem('userEmail');

            if (savedFirstName) {
                document.getElementById('firstName').value = savedFirstName;
            }
            if (savedLastName) {
                document.getElementById('lastName').value = savedLastName;
            }
            if (savedEmail) {
                document.getElementById('userEmailInput').value = savedEmail;
            }

            if (savedFirstName && savedLastName) {
                document.querySelector('.full-name').textContent = `${savedFirstName} ${savedLastName}`;
            }
        }

        // Navbar shrink functionality
        window.addEventListener('scroll', function() {
            const navbar = document.getElementById('main-navbar');
            if (window.scrollY > 50) {
                navbar.classList.add('shrink');
            } else {
                navbar.classList.remove('shrink');
            }
        });

        // Initialize all features when page loads
        document.addEventListener('DOMContentLoaded', function() {
            loadSavedImages();
            loadSavedName();
            initializeProfileFeatures();
            initializeStatusFeatures();
            showSection('p-n-p');
            // Set initial active state for Profile
            const profileItem = document.querySelector('.sdbr1-menu .dropdown-item.profile').closest('li');
            if (profileItem) {
                profileItem.classList.add('active');
            }
            initializeFileUpload();

            // Close dropdowns when clicking outside - disabled
            // document.addEventListener('click', function(e) {
            //     if (!e.target.closest('.sdbr1-menu')) {
            //         document.querySelectorAll('.sub-dropdown.open').forEach(li => li.classList.remove('open'));
            //     }
            // });

            // Add sidebar toggle functionality
            document.getElementById('userIcon').addEventListener('click', function() {
                const sidebar = document.getElementById('sidebar');
                sidebar.classList.toggle('open');
            });

            // Add reset size functionality
            const resetBtn = document.querySelector('.reset-size-btn');
            if (resetBtn) {
                resetBtn.addEventListener('click', function() {
                    const boxes = document.querySelectorAll('.upld-boxes');
                    boxes.forEach(box => {
                        box.style.removeProperty('width');
                        box.style.removeProperty('height');
                    });
                    showNotification('Box sizes reset to original!', 'success');
                });
            }

            // Add toggle sdbr2 functionality
            const toggleBtn = document.getElementById('toggleSdbr2');
            if (toggleBtn) {
                toggleBtn.addEventListener('click', toggleSdbr2);
            }

            // Add fadeOut animation
            const fadeOutStyle = document.createElement('style');
            fadeOutStyle.textContent = `
                @keyframes fadeOut {
                    from { opacity: 1; }
                    to { opacity: 0; }
                }
            `;
            document.head.appendChild(fadeOutStyle);
        });

        // File upload functionality
        function initializeFileUpload() {
            const uploadContainer = document.querySelector('.upload-container');
            const fileInput = document.getElementById('file-upload');

            uploadContainer.addEventListener('click', () => {
                fileInput.click();
            });

            uploadContainer.addEventListener('dragover', (e) => {
                e.preventDefault();
                uploadContainer.style.borderColor = '#0057b8';
                uploadContainer.style.background = '#f0f8ff';
            });

            uploadContainer.addEventListener('dragleave', () => {
                uploadContainer.style.borderColor = '#ccc';
                uploadContainer.style.background = '#f9f9f9';
            });

            uploadContainer.addEventListener('drop', (e) => {
                e.preventDefault();
                uploadContainer.style.borderColor = '#ccc';
                uploadContainer.style.background = '#f9f9f9';
                handleFileUpload(e.dataTransfer.files);
            });

            fileInput.addEventListener('change', (e) => {
                handleFileUpload(e.target.files);
            });
        }

        function handleFileUpload(files) {
            showUploadModal(files);
        }

        function showUploadModal(files) {
            const modal = document.createElement('div');
            modal.className = 'upload-modal';
            let filesList = '';
            let previewFile = null;
            for (let file of files) {
                filesList += `<li>${file.name} (${(file.size / 1024).toFixed(2)} KB)</li>`;
                if ((file.type === 'application/pdf' || file.type.includes('word') || file.type.includes('document')) && !previewFile) {
                    previewFile = file;
                }
            }
            modal.innerHTML = `
                <div class="upload-modal-content">
                    <div class="upload-modal-header">
                        <h3>Upload Document</h3>
                        <button class="upload-modal-close" onclick="closeUploadModal()">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    <div class="upload-modal-body">
                        <div class="modal-left">
                            ${previewFile ? (previewFile.type === 'application/pdf' ? `<div class="pdf-preview"><canvas id="pdf-canvas"></canvas></div>` : `<div class="file-preview"><embed src="${URL.createObjectURL(previewFile)}" type="${previewFile.type}" width="100%" height="400px" style="border: 1px solid #ddd; border-radius: 8px;"></embed></div>`) : ''}
                        </div>
                        <div class="modal-right">
                            <div class="upload-form">
                                <input type="text" id="doc-title" placeholder="Title" required>
                                <input type="text" id="doc-author" placeholder="Author">
                                <textarea id="doc-description" placeholder="Description" rows="3"></textarea>
                            </div>
                            <ul class="uploaded-files-list">
                                ${filesList.replace(/<li>(.*?)<\/li>/g, '<li><span class="file-info">$1</span><button class="file-delete-btn" onclick="removeFile(this)">üóëÔ∏è</button></li>')}
                            </ul>
                        </div>
                    </div>
                    <div class="modal-buttons">
                        <div class="modal-buttons-left">
                            <button class="btn-add-file" onclick="addMoreFiles()">Add File</button>
                            <button class="btn-clear-all" onclick="clearAllFiles()">Clear All</button>
                        </div>
                        <div class="modal-buttons-right">
                            <button class="btn-cancel" onclick="closeUploadModal()">Cancel</button>
                            <button class="btn-upload" onclick="submitUpload()">Upload</button>
                        </div>
                    </div>
                </div>
            `;

            // Add modal styles
            modal.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0, 0, 0, 0.5);
                display: flex;
                justify-content: center;
                align-items: center;
                z-index: 1000;
                animation: fadeIn 0.3s ease;
            `;

            const style = document.createElement('style');
            style.textContent = `
                .upload-modal-content {
                    background: white;
                    border-radius: 12px;
                    width: 60%;
                    height: 650px;
                    box-shadow: 0 10px 30px rgba(0,0,0,0.3);
                    display: flex;
                    flex-direction: column;
                    animation: slideIn 0.3s ease;
                    overflow-y: auto;
                    overflow-x: hidden;
                }

                .upload-modal-content.has-additional {
                    overflow-y: auto;
                }

                .upload-modal-header {
                    display: flex;
                    justify-content: space-between;
                    align-items: center;
                    padding: 20px;
                    border-bottom: 1px solid #eee;
                    position: sticky;
                    top: 0;
                    background: white;
                    z-index: 10;
                }

                .upload-modal-header h3 {
                    margin: 0;
                    color: #0057b8;
                }

                .upload-modal-close {
                    background: none;
                    border: none;
                    font-size: 20px;
                    cursor: pointer;
                    color: #666;
                }

                .upload-modal-body {
                    padding: 20px;
                    display: flex;
                    height: 520px;
                }

                .modal-left {
                    flex: 1;
                    padding-right: 20px;
                    display: flex;
                    justify-content: center;
                    align-items: center;
                    margin-top: 20px;
                }

                .modal-right {
                    flex: 1;
                    display: flex;
                    flex-direction: column;
                }

                .modal-buttons {
                    padding: 20px;
                    border-top: 1px solid #eee;
                    display: flex;
                    justify-content: space-between;
                    gap: 10px;
                    background: white;
                }

                .modal-left {
                    flex: 1;
                    padding-right: 20px;
                    display: flex;
                    justify-content: center;
                    align-items: center;
                }

                .pdf-preview, .file-preview {
                    max-width: 100%;
                    max-height: 400px;
                    display: flex;
                    justify-content: center;
                    align-items: center;
                }

                .pdf-preview canvas, .file-preview embed {
                    max-width: 100%;
                    max-height: 100%;
                    object-fit: contain;
                    border-radius: 8px;
                }

                .modal-right {
                    flex: 1;
                    display: flex;
                    flex-direction: column;
                }

                .pdf-preview {
                    margin-bottom: 20px;
                    text-align: center;
                }


                .upload-form {
                    margin: 20px 0;
                    display: flex;
                    flex-direction: column;
                    gap: 10px;
                }

                .upload-form input, .upload-form textarea {
                    padding: 8px;
                    border: 1px solid #ddd;
                    border-radius: 4px;
                    font-family: inherit;
                }

                .upload-form textarea {
                    resize: vertical;
                }

                #pdf-canvas {
                    max-width: 100%;
                    max-height: 400px;
                    border: 1px solid #ddd;
                    border-radius: 8px;
                    object-fit: contain;
                }

                [id^="pdf-canvas-"] {
                    max-width: 100%;
                    max-height: 400px;
                    border: 1px solid #ddd;
                    border-radius: 8px;
                    object-fit: contain;
                    aspect-ratio: 1;
                }

                .additional-modal-body {
                    padding: 20px;
                    margin-top: 20px;
                }

                .additional-modal-body .modal-left {
                    margin-top: 20px;
                    aspect-ratio: 1;
                    display: flex;
                    justify-content: center;
                    align-items: center;
                }

                .pdf-navigation {
                    display: flex;
                    justify-content: space-between;
                    align-items: center;
                    padding: 10px;
                    background: rgba(255, 255, 255, 0.9);
                    border-radius: 6px;
                    margin-top: 10px;
                }

                .pdf-nav-btn {
                    padding: 5px 10px;
                    border: 1px solid #ddd;
                    background: white;
                    border-radius: 4px;
                    cursor: pointer;
                    font-size: 12px;
                }

                .pdf-nav-btn:hover {
                    background: #f8f9fa;
                }

                .pdf-nav-btn:disabled {
                    opacity: 0.5;
                    cursor: not-allowed;
                }

                .pdf-page-info {
                    font-size: 12px;
                    color: #666;
                }

                .modal-buttons {
                    margin-top: 20px;
                    display: flex;
                    justify-content: space-between;
                    gap: 10px;
                }

                .modal-buttons-left {
                    display: flex;
                    gap: 10px;
                }

                .btn-cancel, .btn-upload, .btn-add-file, .btn-clear-all {
                    padding: 10px 20px;
                    border: none;
                    border-radius: 4px;
                    cursor: pointer;
                    font-weight: 500;
                }

                .btn-add-file {
                    background: #28a745;
                    color: white;
                }

                .btn-add-file:hover {
                    background: #218838;
                }

                .btn-clear-all {
                    background: #dc3545;
                    color: white;
                }

                .btn-clear-all:hover {
                    background: #c82333;
                }

                .btn-cancel {
                    background: #f0f0f0;
                    color: #666;
                }

                .btn-cancel:hover {
                    background: #e0e0e0;
                }

                .btn-upload {
                    background: #0057b8;
                    color: white;
                }

                .btn-upload:hover {
                    background: #003f8a;
                }

                .uploaded-files-list {
                    list-style: none;
                    padding: 0;
                    margin: 0;
                    background: #f9f9f9;
                    border-radius: 8px;
                    padding: 15px;
                    margin-top: auto;
                }

                .uploaded-files-list li {
                    padding: 8px 0;
                    border-bottom: 1px solid #eee;
                    display: flex;
                    justify-content: space-between;
                    align-items: center;
                }

                .file-info {
                    flex: 1;
                }

                .file-delete-btn {
                    background: none;
                    border: none;
                    color: #dc3545;
                    cursor: pointer;
                    padding: 5px;
                    border-radius: 3px;
                    transition: background 0.2s ease;
                    font-size: 16px;
                }

                .file-delete-btn:hover {
                    background: rgba(220, 53, 69, 0.1);
                }

                .uploaded-files-list li:last-child {
                    border-bottom: none;
                }

                .dark-mode .upload-modal-content {
                    background: #232f41;
                    color: #e2e8f0;
                }

                .dark-mode .upload-modal-header {
                    border-bottom-color: #374151;
                }

                .dark-mode .uploaded-files-list {
                    background: #374151;
                }
            `;

            document.head.appendChild(style);
            document.body.appendChild(modal);

            if (previewFile && previewFile.type === 'application/pdf') {
                renderPDF(previewFile);
            }
        }

        function renderPDF(file, canvasId) {
            const canvas = document.getElementById(canvasId || 'pdf-canvas');
            const context = canvas.getContext('2d');
            pdfjsLib.getDocument(URL.createObjectURL(file)).promise.then(function(pdf) {
                pdf.getPage(1).then(function(page) {
                    const desiredHeight = 400;
                    const viewport = page.getViewport({scale: 1});
                    const scale = (desiredHeight / viewport.height) * 2; // Increase scale for sharper rendering
                    const scaledViewport = page.getViewport({scale: scale});
                    canvas.height = scaledViewport.height;
                    canvas.width = scaledViewport.width;

                    const renderContext = {
                        canvasContext: context,
                        viewport: scaledViewport
                    };
                    page.render(renderContext);
                });
            });
        }

        function closeUploadModal() {
            const modal = document.querySelector('.upload-modal');
            if (modal) {
                modal.style.animation = 'fadeOut 0.3s ease';
                modal.style.animationFillMode = 'forwards';
                setTimeout(() => {
                    modal.remove();
                    // Reset the file input to allow re-uploading the same files
                    const fileInput = document.getElementById('file-upload');
                    if (fileInput) {
                        fileInput.value = '';
                    }
                }, 300);
            }
        }

        function submitUpload() {
            // Get form data
            const title = document.getElementById('doc-title').value;
            const author = document.getElementById('doc-author').value;
            const description = document.getElementById('doc-description').value;

            if (!title) {
                showNotification('Please enter a title', 'error');
                return;
            }

            // Here you would typically send the data to server
            showNotification('Document uploaded successfully!', 'success');
            closeUploadModal();
            // Reset the file input after successful upload
            const fileInput = document.getElementById('file-upload');
            if (fileInput) {
                fileInput.value = '';
            }
        }

        // Remove file from upload list
        function removeFile(btn) {
            const li = btn.parentElement;
            li.remove();

            // Check if there are any files left
            const remainingFiles = document.querySelectorAll('.uploaded-files-list li');
            if (remainingFiles.length === 0) {
                // Remove the preview area if no files left
                const modalLeft = document.querySelector('.modal-left');
                if (modalLeft) {
                    modalLeft.innerHTML = '';
                }
            } else {
                // Update preview with the next available file
                const firstFile = remainingFiles[0];
                const fileInfo = firstFile.querySelector('.file-info').textContent;
                const fileName = fileInfo.split(' (')[0]; // Extract filename

                // Find the corresponding file in the original files array
                // This is a simplified approach - in a real app you'd track files properly
                const modalLeft = document.querySelector('.modal-left');
                if (modalLeft && modalLeft.innerHTML.includes('pdf-preview')) {
                    // If it was a PDF, keep the preview area but it would need to be updated
                    // For now, we'll just clear it since we don't have the actual file objects
                    modalLeft.innerHTML = '';
                }
            }

            showNotification('File removed from upload list!', 'info');
        }

        // Add more files to upload
        function addMoreFiles() {
            // Create a new file input for additional files
            const additionalFileInput = document.createElement('input');
            additionalFileInput.type = 'file';
            additionalFileInput.accept = 'application/pdf,.doc,.docx';
            additionalFileInput.multiple = true;
            additionalFileInput.style.display = 'none';
            additionalFileInput.addEventListener('change', handleAdditionalFiles);
            document.body.appendChild(additionalFileInput);
            additionalFileInput.click();
            setTimeout(() => document.body.removeChild(additionalFileInput), 1000);
        }

        // Handle adding additional files
        function handleAdditionalFiles(event) {
            const files = event.target.files;
            if (files.length > 0) {
                // Create a new modal body section for the additional files
                const uploadModalContent = document.querySelector('.upload-modal-content');
                if (!uploadModalContent) return;

                const newModalBody = document.createElement('div');
                newModalBody.className = 'upload-modal-body additional-modal-body';
                newModalBody.innerHTML = `
                    <div class="modal-left">
                        ${files[0].type === 'application/pdf' ? `<div class="pdf-preview"><canvas id="pdf-canvas-${Date.now()}"></canvas></div>` : `<div class="file-preview"><embed src="${URL.createObjectURL(files[0])}" type="${files[0].type}" width="100%" height="400px" style="border: 1px solid #ddd; border-radius: 8px;"></embed></div>`}
                    </div>
                    <div class="modal-right">
                        <div class="upload-form">
                            <input type="text" placeholder="Title" required>
                            <input type="text" placeholder="Author">
                            <textarea placeholder="Description" rows="3"></textarea>
                        </div>
                        <ul class="uploaded-files-list">
                            ${Array.from(files).map(file => `<li><span class="file-info">${file.name} (${(file.size / 1024).toFixed(2)} KB)</span><button class="file-delete-btn" onclick="removeFile(this)">üóëÔ∏è</button></li>`).join('')}
                        </ul>
                    </div>
                `;

                // Insert before the modal buttons
                const modalButtons = document.querySelector('.modal-buttons');
                if (modalButtons) {
                    uploadModalContent.insertBefore(newModalBody, modalButtons);
                    // Add class to enable scrolling when additional content is present
                    uploadModalContent.classList.add('has-additional');
                } else {
                    uploadModalContent.appendChild(newModalBody);
                }

                // Render PDF if needed (only first page, no navigation)
                if (files[0].type === 'application/pdf') {
                    const canvasId = newModalBody.querySelector('canvas').id;
                    renderPDF(files[0], canvasId);
                }
            }
            event.target.value = '';
        }

        // Add PDF page navigation
        function addPDFNavigation(modalBody, file) {
            const modalLeft = modalBody.querySelector('.modal-left');
            const pdfContainer = modalLeft.querySelector('.pdf-preview');

            // Create navigation controls
            const navControls = document.createElement('div');
            navControls.className = 'pdf-navigation';
            navControls.innerHTML = `
                <button class="pdf-nav-btn" onclick="previousPDFPage(this)">‚Äπ Previous</button>
                <span class="pdf-page-info">Page <span class="current-page">1</span> of <span class="total-pages">-</span></span>
                <button class="pdf-nav-btn" onclick="nextPDFPage(this)">Next ‚Ä∫</button>
            `;

            pdfContainer.appendChild(navControls);

            // Store PDF info for navigation
            pdfContainer.pdfFile = file;
            pdfContainer.currentPage = 1;
            pdfContainer.totalPages = 0;

            // Load PDF to get total pages
            pdfjsLib.getDocument(URL.createObjectURL(file)).promise.then(function(pdf) {
                pdfContainer.totalPages = pdf.numPages;
                pdfContainer.querySelector('.total-pages').textContent = pdf.numPages;
                pdfContainer.pdfDoc = pdf;
            });
        }

        // Navigate to previous PDF page
        function previousPDFPage(btn) {
            const pdfContainer = btn.closest('.pdf-preview');
            if (pdfContainer.currentPage > 1) {
                pdfContainer.currentPage--;
                renderPDFPage(pdfContainer);
            }
        }

        // Navigate to next PDF page
        function nextPDFPage(btn) {
            const pdfContainer = btn.closest('.pdf-preview');
            if (pdfContainer.currentPage < pdfContainer.totalPages) {
                pdfContainer.currentPage++;
                renderPDFPage(pdfContainer);
            }
        }

        // Render specific PDF page
        function renderPDFPage(pdfContainer) {
            const canvas = pdfContainer.querySelector('canvas');
            const context = canvas.getContext('2d');

            pdfContainer.pdfDoc.getPage(pdfContainer.currentPage).then(function(page) {
                const desiredHeight = 480;
                const viewport = page.getViewport({scale: 1});
                const scale = (desiredHeight / viewport.height) * 2;
                const scaledViewport = page.getViewport({scale: scale});

                canvas.height = scaledViewport.height;
                canvas.width = scaledViewport.width;

                const renderContext = {
                    canvasContext: context,
                    viewport: scaledViewport
                };

                page.render(renderContext);

                // Update page info
                pdfContainer.querySelector('.current-page').textContent = pdfContainer.currentPage;
            });
        }

        // Clear all files from upload list
        function clearAllFiles() {
            const fileList = document.querySelector('.uploaded-files-list');
            if (fileList) {
                fileList.innerHTML = '';
            }

            // Clear the preview area
            const modalLeft = document.querySelector('.modal-left');
            if (modalLeft) {
                modalLeft.innerHTML = '';
            }

            // Reset the file input
            const fileInput = document.getElementById('file-upload');
            if (fileInput) {
                fileInput.value = '';
            }

            showNotification('All files cleared!', 'info');
        }

        // Toggle sdbr2 functionality
        function toggleSdbr2() {
            const sdbr2 = document.querySelector('.sdbr2');
            const mainContent = document.querySelector('.main-content');
            const toggleBtn = document.getElementById('toggleSdbr2');
            const span = toggleBtn.querySelector('span');
            const sidebar = document.getElementById('sdbr1');

            if (sdbr2.style.display === 'none') {
                sdbr2.style.display = 'block';
                mainContent.classList.remove('expanded');
                if (sidebar.classList.contains('collapsed')) {
                    mainContent.style.width = 'calc(100vw - 349px)';
                    mainContent.style.marginRight = '299px';
                } else {
                    mainContent.style.width = '67vw';
                    mainContent.style.marginRight = '299px';
                }
                toggleBtn.style.right = '299px';
                span.textContent = '>';
                document.body.style.overflowX = '';
            } else {
                sdbr2.style.display = 'none';
                mainContent.classList.add('expanded');
                if (sidebar.classList.contains('collapsed')) {
                    mainContent.style.width = 'calc(100vw - 50px)';
                    mainContent.style.marginRight = '0';
                } else {
                    mainContent.style.width = 'calc(100vw - 200px)';
                    mainContent.style.marginRight = '0';
                }
                toggleBtn.style.right = '0px';
                span.textContent = '<';
                document.body.style.overflowX = 'hidden';
            }
        }

        // Mini cover photo change functionality
        function changeMiniCover(event) {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const miniBackgroundContainer = document.querySelector('.mini-background-image-container');
                    const mainBackgroundContainer = document.getElementById('backgroundContainer');
                    miniBackgroundContainer.style.backgroundImage = `url(${e.target.result})`;
                    mainBackgroundContainer.style.backgroundImage = `url(${e.target.result})`;

                    // Save to localStorage for persistence
                    localStorage.setItem('backgroundImage', e.target.result);

                    // Show success notification
                    showNotification('Cover photo updated successfully!', 'success');
                };
                reader.readAsDataURL(file);
            }
        }

        // Mini profile picture change functionality
        function changeMiniProfile(event) {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const miniProfilePic = document.getElementById('miniPfpPic');
                    const mainProfilePic = document.getElementById('pfpPic');
                    miniProfilePic.src = e.target.result;
                    mainProfilePic.src = e.target.result;

                    // Save to localStorage for persistence
                    localStorage.setItem('profilePicture', e.target.result);

                    // Show success notification
                    showNotification('Profile picture updated successfully!', 'success');
                };
                reader.readAsDataURL(file);
            }
        }

        // Update name functionality (auto-update on input)
        function updateNameAuto() {
            const firstName = document.getElementById('firstName').value.trim();
            const lastName = document.getElementById('lastName').value.trim();

            if (firstName && lastName) {
                const fullName = `${firstName} ${lastName}`;
                document.querySelector('.full-name').textContent = fullName;
                localStorage.setItem('userFirstName', firstName);
                localStorage.setItem('userLastName', lastName);
            } else if (firstName || lastName) {
                const partialName = firstName || lastName;
                document.querySelector('.full-name').textContent = partialName;
            }
        }

        // Update email functionality
        function updateEmail() {
            const emailInput = document.getElementById('userEmailInput');
            const currentEmail = emailInput.value;

            if (emailInput.readOnly) {
                // Enable editing
                emailInput.readOnly = false;
                emailInput.focus();
                emailInput.select();
                document.querySelector('.update-email-btn i').className = 'fas fa-check';
                document.querySelector('.update-email-btn').innerHTML = '<i class="fas fa-check"></i> Save Email';
            } else {
                // Save changes
                const newEmail = emailInput.value.trim();
                if (newEmail && newEmail.includes('@') && newEmail !== currentEmail) {
                    emailInput.readOnly = true;
                    localStorage.setItem('userEmail', newEmail);
                    document.querySelector('.update-email-btn i').className = 'fas fa-plus';
                    document.querySelector('.update-email-btn').innerHTML = '<i class="fas fa-plus"></i> Update Email';
                    showNotification('Email updated successfully!', 'success');
                } else if (newEmail === currentEmail) {
                    emailInput.readOnly = true;
                    document.querySelector('.update-email-btn i').className = 'fas fa-plus';
                    document.querySelector('.update-email-btn').innerHTML = '<i class="fas fa-plus"></i> Update Email';
                } else {
                    showNotification('Please enter a valid email address', 'error');
                }
            }
        }

        // Toggle password visibility
        function togglePasswordVisibility(inputId) {
            const input = document.getElementById(inputId);
            const icon = input.nextElementSibling;

            if (input.type === 'password') {
                input.type = 'text';
                icon.className = 'fas fa-eye-slash password-toggle';
            } else {
                input.type = 'password';
                icon.className = 'fas fa-eye password-toggle';
            }
        }

        // Toggle box options menu
        function toggleBoxOptions(btn) {
            const menu = btn.nextElementSibling;
            const allMenus = document.querySelectorAll('.box-options-menu');
            allMenus.forEach(m => {
                if (m !== menu) m.classList.remove('show');
            });
            menu.classList.toggle('show');
        }

        // Delete box functionality
        function deleteBox(element) {
            const box = element.closest('.upld-boxes');
            box.remove();
            showNotification('The Box was Deleted!', 'success');
            // Hide all menus
            document.querySelectorAll('.box-options-menu').forEach(menu => menu.classList.remove('show'));
        }

        // Confirm delete (shows delete button)
        function confirmDelete(btn) {
            const box = btn.closest('.upld-boxes');
            box.classList.toggle('show-delete');
        }

        // Edit box functionality
        function editBox(element) {
            const box = element.closest('.upld-boxes');
            const img = box.querySelector('img');
            const desc = box.querySelector('.upld-dscrpt');

            // Create edit modal
            const modal = document.createElement('div');
            modal.className = 'edit-modal';
            modal.innerHTML = `
                <div class="edit-modal-content">
                    <div class="edit-modal-header">
                        <h3>Edit Box Content</h3>
                        <button class="edit-modal-close" onclick="closeEditModal()">&times;</button>
                    </div>
                    <div class="edit-modal-body">
                        <div class="edit-form-group">
                            <label>Image URL:</label>
                            <input type="text" id="editImageUrl" value="${img.src}" placeholder="Enter image URL">
                        </div>
                        <div class="edit-form-group">
                            <label>Description:</label>
                            <textarea id="editDescription" rows="3" placeholder="Enter description">${desc.textContent}</textarea>
                        </div>
                    </div>
                    <div class="edit-modal-footer">
                        <button class="btn-cancel" onclick="closeEditModal()">Cancel</button>
                        <button class="btn-save" onclick="saveBoxEdit('${box.dataset.boxId || 'box-' + Date.now()}')">Save Changes</button>
                    </div>
                </div>
            `;

            // Add modal styles
            modal.style.cssText = `
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0, 0, 0, 0.5);
                display: flex;
                justify-content: center;
                align-items: center;
                z-index: 1000;
            `;

            const style = document.createElement('style');
            style.textContent = `
                .edit-modal-content {
                    background: white;
                    border-radius: 12px;
                    width: 90%;
                    max-width: 500px;
                    box-shadow: 0 10px 30px rgba(0,0,0,0.3);
                }

                .edit-modal-header {
                    display: flex;
                    justify-content: space-between;
                    align-items: center;
                    padding: 20px;
                    border-bottom: 1px solid #eee;
                }

                .edit-modal-header h3 {
                    margin: 0;
                    color: #0057b8;
                }

                .edit-modal-close {
                    background: none;
                    border: none;
                    font-size: 24px;
                    cursor: pointer;
                    color: #666;
                }

                .edit-modal-body {
                    padding: 20px;
                }

                .edit-form-group {
                    margin-bottom: 15px;
                }

                .edit-form-group label {
                    display: block;
                    margin-bottom: 5px;
                    font-weight: 500;
                    color: #333;
                }

                .edit-form-group input, .edit-form-group textarea {
                    width: 100%;
                    padding: 10px;
                    border: 1px solid #ddd;
                    border-radius: 4px;
                    font-family: inherit;
                }

                .edit-modal-footer {
                    padding: 20px;
                    border-top: 1px solid #eee;
                    display: flex;
                    justify-content: flex-end;
                    gap: 10px;
                }

                .btn-cancel, .btn-save {
                    padding: 10px 20px;
                    border: none;
                    border-radius: 4px;
                    cursor: pointer;
                    font-weight: 500;
                }

                .btn-cancel {
                    background: #f0f0f0;
                    color: #666;
                }

                .btn-save {
                    background: #0057b8;
                    color: white;
                }
            `;

            document.head.appendChild(style);
            document.body.appendChild(modal);

            // Hide options menu
            document.querySelectorAll('.box-options-menu').forEach(menu => menu.classList.remove('show'));
        }

        // Close edit modal
        function closeEditModal() {
            const modal = document.querySelector('.edit-modal');
            if (modal) {
                modal.remove();
            }
        }

        // Save box edit
        function saveBoxEdit(boxId) {
            const imageUrl = document.getElementById('editImageUrl').value;
            const description = document.getElementById('editDescription').value;

            // Find the box (for now, we'll just update the first one since we don't have IDs)
            const boxes = document.querySelectorAll('.upld-boxes');
            const box = boxes[0]; // This should be improved to target the specific box

            if (box) {
                const img = box.querySelector('img');
                const desc = box.querySelector('.upld-dscrpt');

                if (imageUrl) img.src = imageUrl;
                if (description) desc.textContent = description;

                showNotification('Box content updated successfully!', 'success');
            }

            closeEditModal();
        }


        // Keyboard shortcuts
        document.addEventListener('keydown', function(e) {
            // Ctrl/Cmd + P to change profile picture
            if ((e.ctrlKey || e.metaKey) && e.key === 'p') {
                e.preventDefault();
                document.getElementById('profileUpload').click();
            }

            // Ctrl/Cmd + S to update status
            if ((e.ctrlKey || e.metaKey) && e.key === 's') {
                e.preventDefault();
                document.getElementById('statusCloud').click();
            }
        });
    </script>
</body>
</html>
