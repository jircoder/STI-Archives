    <!--Index.html-->
    <!DOCTYPE html>
    <html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>LogIn | STI Archives</title>
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
        <style>
            body {
                margin: 0;
                padding: 0;
                font-family: 'Poppins', Arial, sans-serif;
                min-height: 100vh;
                display: flex;
                align-items: center;
                justify-content: center;
                background: url('STI Building medium-dark.png') no-repeat center center fixed;
                background-size: cover;
                position: relative;
            }
            body::before {
                content: "";
                position: fixed;
                top: 0; left: 0; right: 0; bottom: 0;
                background: rgba(20, 34, 56, 0.55);
                z-index: 0;
                pointer-events: none;
            }
            .main-content {
                position: relative;
                z-index: 1;
                display: flex;
                flex-direction: column;
                align-items: center;
                justify-content: center;
                padding: 0 5vw;
            }
            .auth-container {
                background: #fff;
                border-radius: 16px;
                box-shadow: 0 2px 16px #0002;
                padding: 25px 35px;
                width: 40vw;
                max-width:350px;
                max-height:70vh;
                overflow-y: auto;
                transition: width 0.3s ease;
            }
            .auth-container.auth-container--signup {
                width: 40vw;
                max-width: 350px;
            }
            .auth-container2 {
                background: #fff;
                border-radius: 16px;
                box-shadow: 0 2px 16px #0002;
                
                width: 450px;
                max-width: 100vw;
                color: #132a3f;
                display: none;
            }
            .auth-tabs {
                display: flex;
                justify-content: center;
                margin-bottom: 17px;
            }
            .auth-tab {
                flex: 1;
                text-align: center;
                padding: 10px 0;
                cursor: pointer;
                font-weight: 600;
                color: #132a3f;
                border-bottom: 2px solid transparent;
                transition: border 0.2s, color 0.2s;
            }
            .auth-tab.active {
                color: #0057b8;
                border-bottom: 2.5px solid #0057b8;
            }
            .auth-tab:not(.active):hover {
                color: #666;
            }
            .auth-form {
                display: none;
                flex-direction: column;
                gap: 14px;
            }
            .auth-form.active {
                display: flex;
            }
            .form-group {
                display: flex;
                flex-direction: column;
            }
            .auth-form label {
                font-size: 15px;
                font-weight: 500;
                margin-bottom: 4px;
            }
            .auth-form input {
                padding: 8px 12px;
                border-radius: 8px;
                border: 1px solid #bfc9d9;
                font-size: 16px;
                outline: none;
                transition: border 0.2s;
            }
            .auth-form input:focus {
                border: 1.5px solid #0057b8;
            }
            .error-message {
                color: red;
                font-size: 14px;
                display: none;
                margin-top: 4px;
                display: flex;
                align-items: center;
                gap: 6px;
            }
            .error-message i {
                color: red;
                font-size: 16px;
            }
            .dark-mode .error-message i {
                color: #ff6b6b !important;
                font-size: 16px;
            }
            .input-error {
                border: 1px solid red !important;
            }
            .auth-form select.input-error {
                border: 1px solid red !important;
            }
            .auth-form select {
                padding: 8px 15px 8px 12px;
                border-radius: 8px;
                border: 1px solid #bfc9d9;
                font-size: 16px;
                outline: none;
                transition: border 0.2s;
                background: #fff;
                color: #000;
            }
            .auth-form select:focus {
                border: 1.5px solid #0057b8;
            }
            .auth-form input[type="file"] {
                padding: 6px 12px;
                border-radius: 8px;
                border: 1px solid #bfc9d9;
                font-size: 16px;
                outline: none;
                transition: border 0.2s;
                background: #fff;
                color: #000;
            }
            .auth-form input[type="file"]:focus {
                border: 1.5px solid #0057b8;
            }
            .auth-form button {
                background: #0057b8;
                color: #fff;
                border: none;
                border-radius: 8px;
                padding: 10px 0;
                font-size: 17px;
                font-weight: 600;
                cursor: pointer;
                transition: background 0.2s;
            }
            .auth-form button:hover {
                background: #0099cc;
            }
            .auth-form .admin-btn {
                background: #ffd700;
                color: #232f41;
                width: 100%;
            }
            .auth-form .admin-btn:hover {
                background: #e6c200;
            }
            .form-footer {
                text-align: center;
                font-size: 14px;
            }
            .form-footer a {
                color: #0057b8;
                text-decoration: none;
                font-weight: 600;
            }
            .form-footer a:hover {
                text-decoration: underline;
            }
            .password-container {
                position: relative;
                display: flex;
                align-items: center;
            }
            .password-container input[type="password"],
            .password-container input[type="text"] {
                width: 100%;
                box-sizing: border-box;
                padding-right: 38px;
            }
            .toggle-password {
                position: absolute;
                right: 10px;
                top: 50%;
                transform: translateY(-50%);
                background: none;
                border: none;
                cursor: pointer;
                color: #888;
                font-size: 18px;
                padding: 0;
                outline: none;
                height: 100%;
                display: flex;
                align-items: center;
                justify-content: center;
                transition: color 0.2s;
            }
            .toggle-password:hover,
            .toggle-password:focus {
                color: #222;
                background: none;
            }
            .auth-form button.toggle-password {
                background: none !important;
                color: #888 !important;
                box-shadow: none !important;
                border: none !important;
                padding: 0 !important;
                margin: 0 !important;
                min-width: 0 !important;
                min-height: 0 !important;
            }
            /* Dark mode styles */
            body.dark-mode {
                background: url('STI Building medium-dark.png') no-repeat center center fixed;
                background-size: cover;
            }
            body.dark-mode::before {
                background: rgba(10, 18, 32, 0.80);
            }
            .dark-mode .auth-container {
                background: #1a2636;
                color: #e2e8f0;
                box-shadow: 0 2px 16px #0006;
            }
            .dark-mode .auth-container2 {
                background-color:#132a3f ;
                color: #fff;
                box-shadow: 0 2px 16px #0002;
            }
            .dark-mode .auth-tab {
                color: #e2e8f0;
            }
            .dark-mode .auth-tab.active {
                color: #ffd700;
                border-bottom: 2.5px solid #ffd700;
            }
            .dark-mode .auth-container2 .auth-tab,
            .dark-mode .auth-container2 .auth-tab.active {
                color: #fff;
                border-bottom-color: #0057b8;
            }
            .dark-mode .auth-container2 .auth-tab.active {
                color: #ffd700;
                border-bottom: 2.5px solid #ffd700;
            }
            .dark-mode .auth-form label {
                color: #fff;
            }
            .dark-mode .auth-container2 .auth-form label {
                color: #fff;
            }
            .dark-mode .auth-form input {
                background: #132a3f ;
                color: #fff;
                border: 1px solid #bfc9d9;
            }
            .dark-mode .auth-container2 .auth-form input {
                background: #132a3f  !important;
                color: #fff !important;
                border: 1px solid #bfc9d9 !important;
            }
            .dark-mode .auth-form select {
                background: #132a3f ;
                color: #6c6b6b;
                border: 1px solid #bfc9d9;
            }
            .dark-mode .auth-container2 .auth-form select {
                background: #132a3f !important;
                color: #132a3f !important;
                border: 1px solid #bfc9d9 !important;
            }
            .dark-mode .auth-form input[type="file"] {
                background:#132a3f ;
                color: #fff;
                border: 1px solid #bfc9d9;
            }
            .dark-mode .auth-container2 .auth-form input[type="file"] {
                background: #fff !important;
                color: #132a3f !important;
                border: 1px solid #bfc9d9 !important;
            }
            .dark-mode .auth-form button {
                background: #ffd700;
                color: #232f41;
            }
            .dark-mode .auth-form button:hover {
                background: #e6c200;
            }
            .dark-mode .auth-form .admin-btn {
                background: #0057b8;
                color: #fff;
            }
            .dark-mode .auth-form .admin-btn:hover {
                background: #0099cc;
            }
            .dark-mode .form-footer a {
                color: #ffd700;
            }
            .dark-mode .auth-container2 .form-footer a {
                color: #0057b8;
            }
            .dark-mode .toggle-password {
                color: #ffd700;
            }
            .dark-mode .auth-container2 .toggle-password {
                color: #fff;
            }
            .dark-mode .toggle-password:hover,
            .dark-mode .toggle-password:focus {
                color: #fff;
            }
            .dark-mode .centered-text {
                color: #ffe;
                text-shadow: 0 2px 8px #000c;
            }
            /* Forgot Password link colors */
            #forgotPassword {
                color: #0057b8;
                transition: color 0.2s;
            }
            #admin-forgotPassword {
                color: #0057b8;
                transition: color 0.2s;
            }
            #forgotPassword:hover,
            #admin-forgotPassword:hover {
                color: #003a7a;
            }
            .dark-mode #forgotPassword {
                color: #ffd700;
            }
            .dark-mode #forgotPassword:hover {
                color: #cca300;
            }
            .dark-mode #admin-forgotPassword {
                color: #ffd700;
            }
            .dark-mode #admin-forgotPassword:hover {
                color: #cca300;
            }
            /* >>> UPDATED: Reversed Toggle Button Styles */
            .dark-mode-toggle {
                position: fixed;
                top: 24px;
                right: 32px;
                z-index: 2;
                border-radius: 50%;
                width: 44px;
                height: 44px;
                display: flex;
                align-items: center;
                justify-content: center;
                cursor: pointer;
                font-size: 1.5rem;
                color: #ffd700; /* Yellow sun in DARK mode */
                background: transparent; /* Transparent in DARK mode */
                border: 2px solid #ffd700; /* Yellow border in DARK mode */
                box-shadow: 0 2px 8px #ffd700;
                transition: all 0.2s ease;
            }
            .dark-mode .dark-mode-toggle {
                border: 2px solid #fff; /* White border in LIGHT mode */
                color: white; 
                background: transparent; 
                box-shadow: 0 2px 8px #353535;
            }
            /* Error message styling */
            .error-message {
                animation: fadeInError 0.3s ease;
            }
            @keyframes fadeInError {
                from { opacity: 0; transform: translateY(-10px); }
                to { opacity: 1; transform: translateY(0); }
            }
            .dark-mode .error-message {
                color: #ff6b6b !important;
            }
            .dark-mode .error-message i {
                color: #ff6b6b !important;
            }
            /* Student back link styling */
            .student-back-link {
                color: #666;
                text-decoration: none;
                transition: color 0.2s;
            }
            .student-back-link:hover {
                color: #999;
            }
            .student-highlight {
                color: #0057b8;
                font-weight: bold;
            }
            .dark-mode .student-back-link {
                color: #b0b7c3;
            }
            .dark-mode .student-back-link:hover {
                color: #e2e8f0;
            }
            .dark-mode .student-highlight {
                color: #ffd700;
            }
            /* Reset Password Modal Styles */
            .reset-pass {
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                display: none; /* Initially hidden */
                justify-content: center;
                align-items: center;
                z-index: 10000;
                animation: fadeIn 0.5s ease;
                /* background: rgba(0, 0, 0, 0.6); REMOVED: No background overlay */
            }
            .reset-pass.show {
                display: flex;
            }
            .reset-pass-content {
                background: #fff;
                border-radius: 20px;
                padding: 30px 30px 20px 30px; /* Reduced padding at bottom */
                margin: 20px;
                text-align: center;
                height:28vh;
                max-width: 400px;
                width: 30%;
                box-shadow: 0 10px 30px rgba(0,0,0,0.3);
                animation: slideUp 0.5s ease;
                position: relative;
            }
            .reset-pass-content h2 {
                color: #0057b8;
                margin: 5px 0 10px 0; /* Reduced top margin */
                font-size: 1.8rem;
            }
            .reset-pass-content p {
                color: #666;
                margin: 0 0 15px 0; /* Reduced bottom margin */
                font-size: 1rem;
            }
            .reset-pass-content input {
                width: 100%;
                padding: 12px 15px;
                border: 1px solid #bfc9d9;
                border-radius: 8px;
                font-size: 16px;
                margin-bottom: 10px; /* Reduced bottom margin */
                outline: none;
                transition: border 0.2s;
                box-sizing: border-box;
            }
            .reset-pass-content input:focus {
                border: 1.5px solid #0057b8;
            }
            .reset-pass-content button {
                background: #0057b8;
                color: #fff;
                border: none;
                border-radius: 8px;
                padding: 12px 30px;
                font-size: 16px;
                font-weight: 600;
                cursor: pointer;
                margin-top: 10px;
                margin-bottom:10000px; /* This seems like an error, likely should be removed or reduced */
                transition: background 0.2s;
            }
            .reset-pass-content button:hover {
                background: #0099cc;
            }
            .close-modal {
                position: absolute;
                top: 15px;
                right: 20px;
                font-size: 28px;
                font-weight: bold;
                color: #aaa;
                cursor: pointer;
                transition: color 0.2s;
                line-height: 1;
            }
            .close-modal:hover {
                color: #000;
            }
            #resetMessage {
                margin-top: 10px; /* Reduced top margin */
                font-size: 14px;
                min-height: 20px;
            }
            /* New error message styling specifically for reset modal input */
            #reset-email-error {
                /* Inherits base .error-message styles */
                margin-top: 4px; /* Space above the error message */
                margin-bottom: 10px; /* Space below the error message, pushing the button down */
                display: none; /* Hidden by default */
            }
            /* Dark mode for reset modal */
            .dark-mode .reset-pass-content {
                background: #1a2636;
                color: #e2e8f0;
            }
            .dark-mode .reset-pass-content h2 {
                color: #ffd700;
            }
            .dark-mode .reset-pass-content p {
                color: #b0b7c3;
            }
            .dark-mode .reset-pass-content input {
                background: #232f41;
                color: #e2e8f0;
                border: 1px solid #374151;
            }
            .dark-mode .reset-pass-content button {
                background: #ffd700;
                color: #232f41;
            }
            .dark-mode .reset-pass-content button:hover {
                background: #e6c200;
            }
            .dark-mode .close-modal {
                color: #e2e8f0;
            }
            .dark-mode .close-modal:hover {
                color: #ffd700;
            }
            .dark-mode #reset-email-error {
                color: #ff6b6b !important;
            }
            .dark-mode #reset-email-error i {
                color: #ff6b6b !important;
            }
            /* Modal Styles */
            .modal {
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0, 0, 0, 0.8);
                display: none;
                justify-content: center;
                align-items: center;
                z-index: 10000;
                animation: fadeIn 0.5s ease;
            }
            .modal.show {
                display: flex;
            }
            .modal-content {
                background: #fff;
                border-radius: 20px;
                padding: 0;
                max-width: 600px;
                width: 90%;
                max-height: 80vh;
                overflow-y: auto;
                box-shadow: 0 10px 30px rgba(0,0,0,0.3);
                animation: slideUp 0.5s ease;
                position: relative;
            }
            .modal-header {
                padding: 20px 30px;
                border-bottom: 1px solid #e0e0e0;
                display: flex;
                justify-content: space-between;
                align-items: center;
            }
            .modal-header h2 {
                margin: 0;
                color: #0057b8;
                font-size: 1.8rem;
            }
            .modal-body {
                padding: 20px 30px;
                color: #333;
            }
            .modal-body h3 {
                color: #0057b8;
                margin-top: 20px;
                margin-bottom: 10px;
            }
            .modal-body p {
                line-height: 1.6;
            }
            .modal-body ul {
                margin: 10px 0;
                padding-left: 20px;
            }
            .modal-body li {
                margin-bottom: 5px;
            }
            .close-modal {
                font-size: 28px;
                font-weight: bold;
                color: #aaa;
                cursor: pointer;
                transition: color 0.2s;
                line-height: 1;
            }
            .close-modal:hover {
                color: #000;
            }
            #resetMessage {
                margin-top: 10px; /* Reduced top margin */
                font-size: 14px;
                min-height: 20px;
            }
            /* Dark mode for modals */
            .dark-mode .modal-content {
                background: #1a2636;
                color: #e2e8f0;
            }
            .dark-mode .modal-header {
                border-bottom: 1px solid #374151;
            }
            .dark-mode .modal-header h2 {
                color: #ffd700;
            }
            .dark-mode .modal-body h3 {
                color: #ffd700;
            }
            .dark-mode .modal-body p {
                color: #e2e8f0;
            }
            .dark-mode .close-modal {
                color: #e2e8f0;
            }
            .dark-mode .close-modal:hover {
                color: #ffd700;
            }
            @keyframes fadeIn {
                from { opacity: 0; }
                to { opacity: 1; }
            }
            @keyframes slideUp {
                from { transform: translateY(50px); opacity: 0; }
                to { transform: translateY(0); opacity: 1; }
            }
            /* Hide auth-container2 by default */
            .auth-container2 {
                display: none;
            }
            .auth-container2 .error-message,
            .auth-container2 .error-message i {
                color: #ff6b6b !important;
            }
            @media (max-width: 768px) {
                .main-content {
                    flex-direction: column;
                    align-items: center;
                    padding: 0;
                }
                .centered-text {
                    text-align: center;
                    margin-top: 18px;
                    margin-bottom: 18px;
                    padding: 0 4vw;
                }
                .centered-text h1 {
                    font-size: 1.3rem;
                    margin-bottom: 7px;
                }
                .centered-text p {
                    font-size: 0.97rem;
                }
                .auth-container {
                    padding: 24px 6vw;
                    width: 60vw;
                    
                    max-height:70vh;
                }
                .auth-container.auth-container--signup {
                    width: 60vw;
                    
                }
                .auth-container2 {
                    padding: 20px 6vw;
                }
                .dark-mode-toggle {
                    top: 10px;
                    right: 10px;
                    width: 38px;
                    height: 38px;
                    font-size: 1.2rem;
                }
                .reset-pass-content {
                    padding: 30px 20px;
                    margin: 20px;
                }
                .reset-pass-content h2 {
                    font-size: 1.5rem;
                }
            }
            @media (max-width:400px) {
                .auth-container {

                    width: 100vw;
                    
                    max-height:70vh;
                }
                .auth-container.auth-container--signup {
                    width: 100vw;
                    
                }
                .auth-container2 {
                    width: 60vw;
                    max-width: 320px;
                }
                .dark-mode-toggle {
                    top: 10px;
                    right: 10px;
                    width: 38px;
                    height: 38px;
                    font-size: 1.2rem;
                }
            }
            /* >>> NEW: Scrollbar Styling for Dark Mode */
            .dark-mode .auth-container::-webkit-scrollbar {
                width: 8px;
            }
            .dark-mode .auth-container::-webkit-scrollbar-track {
                background: #232f41;
            }
            .dark-mode .auth-container::-webkit-scrollbar-thumb {
                background: #4a5568;
                border-radius: 4px;
            }
            .dark-mode .auth-container::-webkit-scrollbar-thumb:hover {
                background: #6b7280;
            }
            /* >>> FIXED: Welcome Modal - Now acts as overlay too */
            #welcomeModal {
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background: rgba(0, 0, 0, 0.6); /* Semi-transparent black */
                z-index: 10000;
                display: flex; /* Display by default */
                justify-content: center;
                align-items: center;
                animation: fadeIn 0.3s ease;
            }
            .welcome-modal-content {
                background: #ffffff;
                border-radius: 16px;
                padding: 32px 40px;
                text-align: center;
                box-shadow: 0 4px 20px rgba(0,0,0,0.1);
                z-index: 10001;
                max-width: 400px;
                width: 90%;
                animation: fadeIn 0.5s ease;
                /* Prevent modal content from closing when clicked */
                pointer-events: auto;
            }
            .dark-mode .welcome-modal-content {
                background: #1a2636;
                color: #e2e8f0;
            }
            .welcome-modal-content h1 {
                font-size: 1.8rem;
                font-weight: 700;
                margin: 0 0 12px 0;
                color: #0057b8;
            }
            .dark-mode .welcome-modal-content h1 {
                color: #ffd700;
            }
            .welcome-modal-content p {
                font-size: 1rem;
                color: #666;
                margin: 0;
            }
            .dark-mode .welcome-modal-content p {
                color: #b0b7c3;
            }
            /* >>> NEW: Success Login Modal (Top Right Corner) */
            .success-login-modal {
                position: fixed;
                top: 20px;
                right: 20px;
                background: #00aa00;
                color: #fff;
                padding: 16px 24px;
                border-radius: 8px;
                box-shadow: 0 4px 12px rgba(0,0,0,0.1);
                z-index: 10002;
                animation: slideInRight 0.3s ease;
                max-width: 300px;
                text-align: center;
            }
            .success-login-modal p {
                margin: 0;
                font-size: 1rem;
                font-weight: 600;
            }
            /* >>> NEW: Reset Sent Modal (Top Right Corner) */
            .reset-sent-modal {
                position: fixed;
                top: 20px;
                right: 20px;
                background: #0099cc; /* Blue background */
                color: #fff;
                padding: 16px 24px;
                border-radius: 8px;
                box-shadow: 0 4px 12px rgba(0,0,0,0.1);
                z-index: 10002;
                animation: slideInRight 0.3s ease;
                max-width: 300px;
                text-align: center;
                display: none; /* Initially hidden */
            }
            .reset-sent-modal p {
                margin: 0;
                font-size: 1rem;
                font-weight: 600;
            }
            @keyframes slideInRight {
                from {
                    opacity: 0;
                    transform: translateX(100%);
                }
                to {
                    opacity: 1;
                    transform: translateX(0);
                }
            }
        </style>
    </head>
    <body>
        <button class="dark-mode-toggle" id="darkModeToggle" aria-label="Toggle dark mode">
            <i class="fa fa-moon"></i>
        </button>
        <div class="main-content">
            <div class="auth-container" id="authContainer">
                <div class="auth-tabs">
                    <div class="auth-tab active" id="loginTab">Log In</div>
                    <div class="auth-tab" id="signupTab">Sign Up</div>
                </div>
                <form class="auth-form active" id="loginForm" autocomplete="off" method="POST" action="javascript:void(0);">
                    <label for="login-email">Email</label>
                    <input type="email" id="login-email" placeholder="username@clmb.sti.archives" required maxlength="45">
                    <span id="login-email-error" class="error-message" style="display: none;"><i class="fas fa-exclamation-circle"></i> Please enter a valid email address.</span>
                    <label for="login-password">Password</label>
                    <div class="password-container">
                        <input type="password" id="login-password" placeholder="Enter your password" required maxlength="64">
                        <button type="button" class="toggle-password" data-target="login-password">
                            <i class="fa fa-eye"></i>
                        </button>
                    </div>
                    <span id="login-password-error" class="error-message" style="display: none;"><i class="fas fa-exclamation-circle"></i> Password is required</span>
                    <div style="display: flex; align-items: center; justify-content: space-between;">
                        <div style="display: flex; align-items: center; gap: 8px;">
                            <input type="checkbox" id="rememberMe">
                            <label for="rememberMe" style="font-size: 14px; margin: 0;">Remember Me</label>
                        </div>
                        <a href="#" id="forgotPassword" style="font-size: 14px; text-decoration:none; ">Forgot Password?</a>
                    </div>
                    <div style="display: flex; align-items: center; gap: 8px; ">
                        <label for="terms-login" style="font-size: 14px; margin: 0; text-align: justify;">
                            <input type="checkbox" id="terms-login" required>
                            By logging in, you acknowledge and agree you have read and agree to be bound by 
                            <a href="#" id="termsLink" style="color: #0057b8;">Terms of Conditions</a> & 
                            <a href="#" id="privacyLink" style="color: #0057b8;">Privacy Policy</a></label>
                    </div>
                    <button type="submit">Login</button>
                    <div id="login-message" style="font-size: 14px; margin-top: 10px; text-align: center; display: none;"></div>
                    <!-- Removed Admin Button -->
                    <div class="form-footer">
                        <p style="font-size: 14px; text-align: center; margin: 10px 0 0 0;">Don't have an Account? <a href="#" id="switchToSignup" style="color: #0057b8; text-decoration: none;">Sign Up</a></p>
                    </div>
                </form>
                <!-- SIGNUP FORM: Single-column -->
                <form class="auth-form" id="signupForm" autocomplete="off" method="POST" action="javascript:void(0);">
                    <div class="form-group">
                        <label for="signup-fullname">Full Name</label>
                        <input type="text" id="signup-fullname" name="fullname" placeholder="Enter your full name" required maxlength="100">
                        <span id="signup-fullname-error" class="error-message" style="display: none;"><i class="fas fa-exclamation-circle"></i> Please enter your full name (first and last name).</span>
                    </div>
                    <div class="form-group">
                        <label for="signup-studentid">Student ID Number</label>
                        <input type="text" id="signup-studentid" name="studentid" placeholder="e.g. 02000xxxxxx" required maxlength="11" pattern="^\d{11}$">
                        <span id="signup-studentid-error" class="error-message" style="display: none;"><i class="fas fa-exclamation-circle"></i> Please enter a valid 11-digit student ID starting with 02000.</span>
                    </div>
                    <div class="form-group">
                        <label for="signup-email">Personal Email</label>
                        <input type="email" id="signup-email" name="email" placeholder="Enter your personal email for notifications" required maxlength="50">
                        <span id="signup-email-error" class="error-message" style="display: none;"><i class="fas fa-exclamation-circle"></i> Please enter a valid email address.</span>
                    </div>
                    <div class="form-group">
                        <label for="signup-role">Role</label>
                        <select id="signup-role" name="role" required>
                            <option value="">Select Role</option>
                            <option value="senior_high">Senior High</option>
                            <option value="college">College</option>
                            <!-- Teacher role removed -->
                        </select>
                        <span id="signup-role-error" class="error-message" style="display: none;"><i class="fas fa-exclamation-circle"></i> Please select a role.</span>
                    </div>
                    <div class="form-group" id="sectionGroup" style="display: none;"> <!-- Initially hidden -->
                        <label for="signup-section">Section</label>
                        <select id="signup-section" name="section" required disabled>
                            <!-- Options will be set dynamically -->
                        </select>
                        <span id="signup-section-error" class="error-message" style="display: none;"><i class="fas fa-exclamation-circle"></i> Please select a section.</span>
                    </div>
                    <div class="form-group">
                        <label for="signup-raf">Registration Assessment Form (RAF)</label>
                        <input type="file" id="signup-raf" name="raf" accept=".pdf,.doc,.docx" required>
                        <span id="signup-raf-error" class="error-message" style="display: none;"><i class="fas fa-exclamation-circle"></i> Please upload your RAF file.</span>
                    </div>
                    <div class="form-group full-width" style="display: flex; align-items: center; gap: 4px; text-align:justify;">
                        <label for="terms-signup" style="font-size: 14px; margin: 0;">
                            <input type="checkbox" id="terms-signup" name="terms" required> 
                            By signing up, you acknowledge and agree you have read and agree to be bound by 
                            <a href="#" id="termsLinkSignup" style="color: #0057b8;">Terms of Conditions</a> & 
                            <a href="#" id="privacyLinkSignup" style="color: #0057b8;">Privacy Policy</a></label>
                    </div>
                    <button type="button" onclick="handleSignup()" class="form-group full-width">Sign Up</button>
                    <div id="signup-message" class="form-group full-width" style="font-size: 14px; margin-top: 10px; text-align: center; display: none;"></div>
                    <div class="form-footer form-group full-width">
                        <p style="font-size: 14px; text-align: center; margin: 10px 0 0 0;">Already have an Account? <a href="#" id="switchToLogin" style="color: #0057b8; text-decoration: none;">Log in</a></p>
                    </div>
                </form>
            </div>
        </div>

        <!-- Welcome Modal (Now acts as overlay too) -->
        <div id="welcomeModal">
            <div class="welcome-modal-content">
                <h1>Welcome to STI Archives!</h1>
                <p>A digital library for showcasing and preserving the works of students and alumni.</p>
            </div>
        </div>

        <!--SECOND FORM ADMIN--> <!-- REMOVED -->
        <!-- Forgot Password Modal -->
        <div id="forgotPasswordModal" class="reset-pass">
            <div class="reset-pass-content">
                <span class="close-modal" onclick="closeResetModal()">&times;</span>
                <h2>Reset Password</h2>
                <p>Enter your email address to reset your password:</p>
                <input type="email" id="resetEmail" placeholder="Enter your Gmail address" required maxlength="45">
                <!-- >>> NEW: Error message span for reset email input -->
                <span id="reset-email-error" class="error-message" style="display: none;"></span>
                <!-- >>> CHANGED: Button text -->
                <button onclick="resetPassword()">Send Reset</button>
                <!-- >>> HIDDEN: General reset message paragraph (kept for JS compatibility) -->
                <p id="resetMessage" style="display: none;"></p>
            </div>
        </div>
        <!-- Terms and Conditions Modal -->
        <div id="termsModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2>Terms and Conditions</h2>
                    <span class="close-modal" onclick="closeModal('termsModal')">&times;</span>
                </div>
                <div class="modal-body">
                    <h3>1. Acceptance of Terms</h3>
                    <p>By accessing and using STI Archives, you agree to comply with these Terms and Conditions. If you do not agree, please discontinue use of the service.</p>
                    <h3>2. User Accounts</h3>
                    <p>Users must provide accurate information (such as full name and Registration Assessment Form). You are responsible for maintaining the confidentiality of your account and activities under it.</p>
                    <h3>3. Content Usage</h3>
                    <p>All research papers, capstone projects, and other content in STI Archives are protected under copyright and academic integrity standards. Unauthorized downloading, copying, or distribution without permission is strictly prohibited and may result in penalties.</p>
                    <h3>4. Prohibited Activities</h3>
                    <ul>
                        <li>Uploading inappropriate, offensive, or non-academic content (e.g., unrelated images or PDFs).</li>
                        <li>Using another person’s work without proper authorization.</li>
                        <li>Attempting to bypass security measures or misuse the website.</li>
                    </ul>
                    <p><strong>Violations may result in suspension of access for up to 1 month or permanent banning for repeated offenses.</strong></p>
                    <h3>5. Privacy</h3>
                    <p>Your personal information, including full name and RAF, is collected for verification and record purposes. For details, please review our Privacy Policy.</p>
                    <h3>6. Enforcement and Penalties</h3>
                    <p>Users who take research files without authorization will face disciplinary actions, which may include temporary suspension, account restriction, or referral to STI College administration for further action.</p>
                    <h3>7. Termination</h3>
                    <p>STI Archives reserves the right to suspend or terminate any account immediately, without prior notice, for violation of these terms.</p>
                    <h3>8. Disclaimer</h3>
                    <p>STI Archives is provided on an "as is" basis. We make no warranties regarding uninterrupted access, completeness of content, or fitness for a particular purpose.</p>
                </div>
            </div>
        </div>
        <!-- Privacy Policy Modal -->
        <div id="privacyModal" class="modal">
            <div class="modal-content">
                <div class="modal-header">
                    <h2>Privacy Policy</h2>
                    <span class="close-modal" onclick="closeModal('privacyModal')">&times;</span>
                </div>
                <div class="modal-body">
                    <h3>1. Information We Collect</h3>
                    <p>We collect the information you provide directly to us, such as when you create an account, upload academic work, or contact us for assistance. This may include your full name and Registration Assessment Form (RAF) for verification purposes.</p>
                    <h3>2. How We Use Your Information</h3>
                    <p>The information we collect is used to verify user identity, manage and improve our services, process submissions, and communicate with you regarding your account and activities within STI Archives.</p>
                    <h3>3. Information Sharing</h3>
                    <p>We do not sell, trade, or share your personal information with outside parties without your consent, except when required by school administration or applicable law.</p>
                    <h3>4. Your Rights</h3>
                    <p>You have the right to request access, correction, or deletion of your personal information at any time. Please contact STI Archives support for such requests.</p>
                    <h3>5. Changes to This Policy</h3>
                    <p>We may update this Privacy Policy from time to time. Any changes will be posted on this page, and continued use of the website means acceptance of the updated policy.</p>
                    <h3>6. Contact Us</h3>
                    <p>If you have any questions or concerns about this Privacy Policy, please reach out to us through the STI Archives support system.</p>
                </div>
            </div>
        </div>
        <!-- RAF Preview Modal -->
        <div id="raf-preview-modal" class="modal">
            <div class="modal-content" style="max-width: 800px; max-height: 90vh;">
                <span class="close-modal" onclick="closeRafModal()">&times;</span>
                <h3>RAF Preview</h3>
                <div id="raf-preview-content" style="margin-top: 15px;"></div>
            </div>
        </div>
        <!-- >>> NEW: Success Login Modal (Top Right) -->
        <div id="successLoginModal" class="success-login-modal" style="display: none;">
            <p>Successfully logged in!</p>
        </div>
        <!-- >>> NEW: Access Granted Modal (Top Right) -->
        <div id="accessGrantedModal" class="success-login-modal" style="display: none;">
            <p>Your account has been created and you have been granted access to our website!</p>
        </div>
        <!-- >>> NEW: Reset Sent Modal (Top Right) -->
        <div id="resetSentModal" class="reset-sent-modal">
            <p>Reset was sent!</p>
        </div>
        <script>
        // ... [ALL YOUR EXISTING JAVASCRIPT REMAINS UNCHANGED] ...
        document.addEventListener('DOMContentLoaded', function () {
            const adminBtn = document.getElementById('adminBtn');
            if (adminBtn) {
                adminBtn.parentElement.remove(); // Remove the entire Admin button container
            }
            const studentMainContent = document.querySelector('.main-content');
            const adminMainContent = document.querySelectorAll('.main-content')[1];
            if (studentMainContent && adminMainContent) {
                // Ensure admin content is hidden since we removed the button
                adminMainContent.style.display = 'none';
            }
        });
        document.addEventListener('DOMContentLoaded', function () {
            const loginTab = document.getElementById('loginTab');
            const signupTab = document.getElementById('signupTab');
            const loginForm = document.getElementById('loginForm');
            const signupForm = document.getElementById('signupForm');
            const authContainer = document.getElementById('authContainer');
            function showLogin() {
                loginTab.classList.add('active');
                signupTab.classList.remove('active');
                loginForm.classList.add('active');
                signupForm.classList.remove('active');
                authContainer.classList.remove('auth-container--signup');
            }
            function showSignup() {
                signupTab.classList.add('active');
                loginTab.classList.remove('active');
                signupForm.classList.add('active');
                loginForm.classList.remove('active');
                authContainer.classList.add('auth-container--signup');
            }
            loginTab.addEventListener('click', showLogin);
            signupTab.addEventListener('click', showSignup);
            const switchToSignup = document.getElementById('switchToSignup');
            const switchToLogin = document.getElementById('switchToLogin');
            if (switchToSignup) {
                switchToSignup.addEventListener('click', function(e) {
                    e.preventDefault();
                    showSignup();
                });
            }
            if (switchToLogin) {
                switchToLogin.addEventListener('click', function(e) {
                    e.preventDefault();
                    showLogin();
                });
            }
            showLogin();
        });
        document.addEventListener('DOMContentLoaded', function () {
            const studentBackLink = document.getElementById('studentBackLink');
            const authContainer = document.querySelector('.auth-container');
            const authContainer2 = document.querySelector('.auth-container2');
            if (studentBackLink && authContainer && authContainer2) {
                studentBackLink.addEventListener('click', function(event) {
                    event.preventDefault();
                    authContainer.style.display = 'block';
                    authContainer2.style.display = 'none';
                });
            }
        });
        document.querySelectorAll('.toggle-password').forEach(btn => {
            btn.addEventListener('click', function () {
                const targetId = this.dataset.target;
                const targetInput = document.getElementById(targetId);
                const icon = this.querySelector('i');
                if (targetInput && icon) {
                    if (targetInput.type === "password") {
                        targetInput.type = "text";
                        icon.classList.remove('fa-eye');
                        icon.classList.add('fa-eye-slash');
                    } else {
                        targetInput.type = "password";
                        icon.classList.remove('fa-eye-slash');
                        icon.classList.add('fa-eye');
                    }
                }
            });
        });
        // ... [Rest of your JS logic remains exactly as before] ...
        const loginEmailInput = document.getElementById('login-email');
        const loginEmailError = document.getElementById('login-email-error');
        const loginPasswordInput = document.getElementById('login-password');
        const loginPasswordError = document.getElementById('login-password-error');
        function validateLoginEmail() {
            const email = loginEmailInput.value.trim();
            const emailRegex = /^[A-Za-z0-9._%+-]+@clmb\.sti\.archives$/;
            if (!email) {
                loginEmailError.innerHTML = '<i class="fas fa-exclamation-circle"></i> Only emails from @clmb.sti.archives are accepted. Please use your official school email.';
                loginEmailError.style.display = 'block';
                loginEmailInput.classList.add('input-error');
                return false;
            } else if (!emailRegex.test(email)) {
                loginEmailError.innerHTML = '<i class="fas fa-exclamation-circle"></i> Only emails from @clmb.sti.archives are accepted. Please use your official school email.';
                loginEmailError.style.display = 'block';
                loginEmailInput.classList.add('input-error');
                return false;
            } else {
                loginEmailError.style.display = 'none';
                loginEmailInput.classList.remove('input-error');
                return true;
            }
        }
        loginEmailInput.addEventListener('input', () => {
            if (loginEmailError.style.display === 'block') {
                const email = loginEmailInput.value.trim();
                const emailRegex = /^[A-Za-z0-9._%+-]+@calamba\.sti\.edu\.ph$/;
                if (email && emailRegex.test(email)) {
                    loginEmailError.style.display = 'none';
                    loginEmailInput.classList.remove('input-error');
                }
            }
        });
        function validateLoginPassword() {
            const password = loginPasswordInput.value;
            if (!password) {
                loginPasswordError.innerHTML = '<i class="fas fa-exclamation-circle"></i> Password is required';
                loginPasswordError.style.display = 'block';
                loginPasswordInput.classList.add('input-error');
                return false;
            } else if (password.length < 8) {
                loginPasswordError.innerHTML = '<i class="fas fa-exclamation-circle"></i> Password must be at least 8 characters long.';
                loginPasswordError.style.display = 'block';
                loginPasswordInput.classList.add('input-error');
                return false;
            } else {
                loginPasswordError.style.display = 'none';
                loginPasswordInput.classList.remove('input-error');
                return true;
            }
        }
        loginPasswordInput.addEventListener('input', () => {
            if (loginPasswordError.style.display === 'block') {
                const password = loginPasswordInput.value;
                if (password.length >= 8) {
                    loginPasswordError.style.display = 'none';
                    loginPasswordInput.classList.remove('input-error');
                }
            }
        });
        function getUsers() {
            return JSON.parse(localStorage.getItem('users')) || [];
        }
        const loginForm = document.getElementById('loginForm');
        loginForm.addEventListener('submit', function(e) {
            e.preventDefault();
            const email = document.getElementById('login-email').value.trim().toLowerCase();
            const password = document.getElementById('login-password').value;
            const rememberMe = document.getElementById('rememberMe').checked;
            const messageDiv = document.getElementById('login-message');
            loginEmailError.style.display = 'none';
            loginPasswordError.style.display = 'none';
            loginEmailInput.classList.remove('input-error');
            loginPasswordInput.classList.remove('input-error');
            let hasErrors = false;
            const emailRegex = /^[A-Za-z0-9._%+-]+@clmb\.sti\.archives$/;
            if (!email) {
                loginEmailError.innerHTML = '<i class="fas fa-exclamation-circle"></i> Only emails from @clmb.sti.archives are accepted. Please use your official school email.';
                loginEmailError.style.display = 'block';
                loginEmailInput.classList.add('input-error');
                hasErrors = true;
            } else if (!emailRegex.test(email)) {
                loginEmailError.innerHTML = '<i class="fas fa-exclamation-circle"></i> Only @clmb.sti.archives are accepted. Please use your official school email.';
                loginEmailError.style.display = 'block';
                loginEmailInput.classList.add('input-error');
                hasErrors = true;
            }
            if (!password) {
                loginPasswordError.innerHTML = '<i class="fas fa-exclamation-circle"></i> Password is required';
                loginPasswordError.style.display = 'block';
                loginPasswordInput.classList.add('input-error');
                hasErrors = true;
            } else if (password.length < 8) {
                loginPasswordError.innerHTML = '<i class="fas fa-exclamation-circle"></i> Password must be at least 8 characters long.';
                loginPasswordError.style.display = 'block';
                loginPasswordInput.classList.add('input-error');
                hasErrors = true;
            }
            if (hasErrors) {
                messageDiv.style.display = 'none';
                return;
            }
            const users = getUsers();
            // Check if user is admin (hardcoded email)
            const isAdmin = email === 'admin@clmb.sti.archives';
            // >>> NEW: Check for user@clmb.sti.archives
            const isUser = email === 'user@clmb.sti.archives';
            const user = users.find(u => u.email === email) || (isAdmin ? null : null);
            // If not found in users, check if it's the hardcoded admin or user
            if (user) {
                if (user.password === password) {
                    localStorage.setItem('currentUser', JSON.stringify(user));
                    if (rememberMe) {
                        localStorage.setItem('rememberMe', email);
                    } else {
                        localStorage.removeItem('rememberMe');
                    }
                    // Show account granted access message for newly verified users
                    showAccessGrantedModal();
                    setTimeout(() => {
                        window.location.href = "Homepage.html";
                    }, 3000);
                } else {
                    messageDiv.textContent = 'Please double-check your credentials and try again.';
                    messageDiv.style.color = 'red';
                    messageDiv.style.display = 'block';
                }
            } else {
                // Check for hardcoded admin account
                if (isAdmin) {
                    const adminCredentials = [
                        { email: 'admin@clmb.sti.archives', password: 'admin123', name: 'Permanent Admin', role: 'admin', id: 'admin-permanent' }
                    ];
                    const admin = adminCredentials.find(u => u.email === email);
                    if (admin && admin.password === password) {
                        localStorage.setItem('currentUser', JSON.stringify(admin));
                        if (rememberMe) {
                            localStorage.setItem('adminRememberMe', email);
                        } else {
                            localStorage.removeItem('adminRememberMe');
                        }
                        // Show success modal
                        showSuccessModal();
                        setTimeout(() => {
                            window.location.href = "admin.html";
                        }, 2000);
                    } else {
                        messageDiv.textContent = 'Invalid password. Please try again.';
                        messageDiv.style.color = '#ff6b6b';
                        messageDiv.style.display = 'block';
                    }
                // >>> NEW: Check for user@calamba.sti.edu.ph
                } else if (isUser) {
                    if (password === 'usertesting') {
                        const userAccount = { email: 'user@clmb.sti.archives', name: 'Test User', role: 'user', id: 'user-test' };
                        localStorage.setItem('currentUser', JSON.stringify(userAccount));
                        if (rememberMe) {
                            localStorage.setItem('userRememberMe', email);
                        } else {
                            localStorage.removeItem('userRememberMe');
                        }
                        // Show success modal
                        showSuccessModal();
                        setTimeout(() => {
                            window.location.href = "Homepage.html";
                        }, 2000);
                    } else {
                        messageDiv.textContent = 'Invalid password for test user.';
                        messageDiv.style.color = '#ff6b6b';
                        messageDiv.style.display = 'block';
                    }
                } else {
                    messageDiv.innerHTML = 'No account found. Please sign up first to create an account <a href="https://docs.google.com/forms/d/e/1FAIpQLSehTNSgVcQqQ8CbF8BFdvL80esUKq7XnuJN2UrbUdZK6_D8YQ/viewform?usp=sharing&ouid=102739092848496404073" target="_blank" style="color: yellow;">here.</a>';
                    messageDiv.style.color = '#ff6b6b';
                    messageDiv.style.display = 'block';
                }
            }
        });
        const signupFullnameInput = document.getElementById('signup-fullname');
        const signupFullnameError = document.getElementById('signup-fullname-error');
        function capitalizeWords(str) {
            return str.replace(/\b\w/g, l => l.toUpperCase());
        }
        function validateFullname() {
            const name = signupFullnameInput.value.trim();
            const words = name.split(/\s+/).filter(word => word.length > 0);
            if (words.length >= 2) {
                signupFullnameError.style.display = 'none';
                signupFullnameInput.classList.remove('input-error');
                return true;
            } else {
                signupFullnameError.style.display = 'flex';
                signupFullnameInput.classList.add('input-error');
                return false;
            }
        }
        signupFullnameInput.addEventListener('input', function() {
            const capitalized = capitalizeWords(this.value);
            if (this.value !== capitalized) {
                this.value = capitalized;
            }
            if (signupFullnameError.style.display === 'flex') {
                validateFullname();
            }
        });
        const signupStudentIdInput = document.getElementById('signup-studentid');
        const signupStudentIdError = document.getElementById('signup-studentid-error');
        function validateStudentId() {
            const id = signupStudentIdInput.value.trim();
            const idRegex = /^02000\d{6}$/;
            if (id && idRegex.test(id)) {
                signupStudentIdError.style.display = 'none';
                signupStudentIdInput.classList.remove('input-error');
                return true;
            } else {
                signupStudentIdError.style.display = 'flex';
                signupStudentIdInput.classList.add('input-error');
                return false;
            }
        }
        signupStudentIdInput.addEventListener('input', function() {
            this.value = this.value.replace(/\D/g, '');
            if (signupStudentIdError.style.display === 'flex') {
                validateStudentId();
            }
        });
        const signupRoleSelect = document.getElementById('signup-role');
        const signupRoleError = document.getElementById('signup-role-error');
        const signupSectionSelect = document.getElementById('signup-section');
        const signupSectionError = document.getElementById('signup-section-error');
        const sectionGroup = document.getElementById('sectionGroup'); // Reference to the section group div

        function validateRole() {
            const role = signupRoleSelect.value;
            if (!role) {
                signupRoleError.style.display = 'flex';
                signupRoleSelect.classList.add('input-error');
                sectionGroup.style.display = 'none'; // Hide section group if role is empty
                signupSectionSelect.disabled = true; // Disable section select
                return false;
            } else {
                signupRoleError.style.display = 'none';
                signupRoleSelect.classList.remove('input-error');
                sectionGroup.style.display = 'flex'; // Show section group if role is selected
                signupSectionSelect.disabled = false; // Enable section select
                return true;
            }
        }

        function validateSection() {
            const section = signupSectionSelect.value;
            if (!section) {
                signupSectionError.style.display = 'flex';
                signupSectionSelect.classList.add('input-error');
                return false;
            } else {
                signupSectionError.style.display = 'none';
                signupSectionSelect.classList.remove('input-error');
                return true;
            }
        }

        function updateSectionOptions() {
            const role = signupRoleSelect.value;
            signupSectionSelect.innerHTML = '';
            const defaultOption = document.createElement('option');
            defaultOption.value = '';
            defaultOption.textContent = 'Select Section';
            signupSectionSelect.appendChild(defaultOption);

            if (!role) {
                // If no role is selected, hide the section group and disable the select
                sectionGroup.style.display = 'none';
                signupSectionSelect.disabled = true;
                signupSectionError.style.display = 'none'; // Clear any existing section error
                return;
            }

            // If a role is selected, show the section group and enable the select
            sectionGroup.style.display = 'flex';
            signupSectionSelect.disabled = false;

            if (role === 'senior_high') {
                [
                    { value: 'abm', text: 'ABM' },
                    { value: 'cularts', text: 'CulArts' },
                    { value: 'itmawd', text: 'ITMAWD' },
                    { value: 'stem', text: 'STEM' } // Added STEM option
                ].forEach(opt => {
                    const option = document.createElement('option');
                    option.value = opt.value;
                    option.textContent = opt.text;
                    signupSectionSelect.appendChild(option);
                });
            } else if (role === 'college') {
                [
                    { value: 'bsba', text: 'BSBA' },
                    { value: 'bscs', text: 'BSCS' },
                    { value: 'bsit', text: 'BSIT' }
                ].forEach(opt => {
                    const option = document.createElement('option');
                    option.value = opt.value;
                    option.textContent = opt.text;
                    signupSectionSelect.appendChild(option);
                });
            } else if (role === 'teacher') {
                const option = document.createElement('option');
                option.value = 'teacher';
                option.textContent = 'Teacher';
                signupSectionSelect.appendChild(option);
            }
        }

        // Event listeners for role and section
        signupRoleSelect.addEventListener('change', function() {
            updateSectionOptions();
            validateRole(); // Validate role after change
            validateSection(); // Validate section after options update (will fail if no section selected)
        });

        // Initial setup: hide section group and disable select
        sectionGroup.style.display = 'none';
        signupSectionSelect.disabled = true;

        // Initialize section options based on current role value (likely empty on load)
        updateSectionOptions();

        // Validate section when it changes
        signupSectionSelect.addEventListener('change', validateSection);

        function handleSignup() {
            let valid = true;
            if (!validateFullname()) valid = false;
            if (!validateStudentId()) valid = false;
            if (!validateRole()) valid = false;
            if (!validateSection()) valid = false;

            const rafInput = document.getElementById('signup-raf');
            const rafError = document.getElementById('signup-raf-error');
            if (!rafInput.files.length) {
                rafError.style.display = 'flex';
                rafInput.classList.add('input-error');
                valid = false;
            } else {
                rafError.style.display = 'none';
                rafInput.classList.remove('input-error');
            }

            if (!valid) return;

            const fullname = document.getElementById('signup-fullname').value.trim();
            const personalEmail = document.getElementById('signup-email').value.trim();
            const studentId = document.getElementById('signup-studentid').value.trim();
            const role = document.getElementById('signup-role').value;
            const section = document.getElementById('signup-section').value;

            // Handle file upload to backend
            const formData = new FormData();
            formData.append('fullname', fullname);
            formData.append('personal_email', personalEmail);
            formData.append('student_id', studentId);
            formData.append('role', role);
            formData.append('section', section);
            formData.append('raf', rafInput.files[0]);

            if (!valid) return;

            const messageDiv = document.getElementById('signup-message');
            messageDiv.textContent = 'Creating your account...';
            messageDiv.style.color = '#0057b8';
            messageDiv.style.display = 'block';

            // Send signup data to backend with file
            fetch('/api/signup_user', {
                method: 'POST',
                body: formData
            })
            .then(response => response.json())
            .then(result => {
                if (result.status === 'success') {
                    messageDiv.textContent = 'Please wait a while for admin to verify your credentials.';
                    messageDiv.style.color = '#28a745';
                    messageDiv.style.display = 'block';

                    // Optional: Reset form
                    document.getElementById('signupForm').reset();
                    document.getElementById('sectionGroup').style.display = 'none';
                    document.getElementById('signup-section').disabled = true;
                } else {
                    messageDiv.textContent = 'Failed to create account: ' + (result.error || 'Unknown error');
                    messageDiv.style.color = '#ff6b6b';
                    messageDiv.style.display = 'block';
                }
            })
            .catch(error => {
                console.error('Error creating account:', error);
                messageDiv.textContent = 'Failed to create account. Please check your connection.';
                messageDiv.style.color = '#ff6b6b';
            });
        }
        const darkModeToggle = document.getElementById('darkModeToggle');
        const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
        const savedMode = localStorage.getItem('darkMode');
        function setDarkMode(on) {
            document.body.classList.toggle('dark-mode', on);
            const icon = darkModeToggle.querySelector('i');
            if (on) {
                // Dark mode: show moon
                icon.classList.remove('fa-sun');
                icon.classList.add('fa-moon');
            } else {
                // Light mode: show sun
                icon.classList.remove('fa-moon');
                icon.classList.add('fa-sun');
            }
            localStorage.setItem('darkMode', on ? 'on' : 'off');
        }
        // Initialize: if savedMode is 'on' OR system prefers dark → enable dark mode
        setDarkMode(savedMode === 'on' || (savedMode === null && prefersDark));
        darkModeToggle.onclick = () => {
            setDarkMode(!document.body.classList.contains('dark-mode'));
        };
        // Migration: Update old domain emails to new domain
        function migrateEmailDomains() {
            const keys = ['rememberMe', 'adminRememberMe', 'userRememberMe'];
            keys.forEach(key => {
                const storedEmail = localStorage.getItem(key);
                if (storedEmail && storedEmail.includes('@calamba.sti.edu.ph')) {
                    const newEmail = storedEmail.replace('@calamba.sti.edu.ph', '@clmb.sti.archives');
                    localStorage.setItem(key, newEmail);
                }
            });
        }
        migrateEmailDomains();

        const rememberedEmail = localStorage.getItem('rememberMe');
        // >>> UPDATED: Check for user remember me too
        const rememberedUserEmail = localStorage.getItem('userRememberMe');
        if (rememberedEmail) {
            document.getElementById('login-email').value = rememberedEmail;
            document.getElementById('rememberMe').checked = true;
        } else if (rememberedUserEmail) {
            document.getElementById('login-email').value = rememberedUserEmail;
            document.getElementById('rememberMe').checked = true;
        }
        // Pre-fill with domain for convenience
        const emailInput = document.getElementById('login-email');
        if (!emailInput.value) {
            emailInput.value = '@clmb.sti.archives';
            emailInput.setSelectionRange(0, 0); // Place cursor at start
        }
        const forgotPasswordLink = document.getElementById('forgotPassword');
        forgotPasswordLink.addEventListener('click', function(e) {
            e.preventDefault();
            showResetModal();
        });
        function showResetModal() {
            const modal = document.getElementById('forgotPasswordModal');
            modal.classList.add('show');
            document.body.style.overflow = 'hidden';
            // Clear input and any previous messages/errors when modal opens
            document.getElementById('resetEmail').value = '';
            document.getElementById('resetMessage').textContent = '';
            document.getElementById('reset-email-error').style.display = 'none';
            document.getElementById('resetEmail').classList.remove('input-error');
            // Add real-time input validation listener
            const resetEmailInput = document.getElementById('resetEmail');
            resetEmailInput.addEventListener('input', validateResetEmailFormat);
        }
        function closeResetModal() {
            const modal = document.getElementById('forgotPasswordModal');
            modal.classList.remove('show');
            document.body.style.overflow = 'auto';
            document.getElementById('resetEmail').value = '';
            document.getElementById('resetMessage').textContent = '';
            // Hide and clear the custom error message
            const resetEmailError = document.getElementById('reset-email-error');
            if (resetEmailError) {
                resetEmailError.style.display = 'none';
                resetEmailError.textContent = '';
            }
            // Remove the input listener when closing
            const resetEmailInput = document.getElementById('resetEmail');
            resetEmailInput.removeEventListener('input', validateResetEmailFormat);
        }
        window.addEventListener('click', function(e) {
            const forgotModal = document.getElementById('forgotPasswordModal');
            if (e.target === forgotModal) {
                closeResetModal();
            }
            const rafModal = document.getElementById('raf-preview-modal');
            if (e.target === rafModal) {
                closeRafModal();
            }
            // Handle welcome modal click outside - FIXED
            const welcomeModal = document.getElementById('welcomeModal');
            if (e.target === welcomeModal) { // Only close if clicked on the overlay part (not the content)
                welcomeModal.style.display = 'none';
            }
            // Handle reset sent modal click outside
            const resetSentModal = document.getElementById('resetSentModal');
            if (e.target === resetSentModal) {
                resetSentModal.style.display = 'none';
            }
        });
        // >>> NEW: Real-time validation for reset email input format
        function validateResetEmailFormat() {
            const emailInput = document.getElementById('resetEmail');
            const email = emailInput.value.trim();
            const errorMessageElement = document.getElementById('reset-email-error');

            // Clear previous messages and error states
            errorMessageElement.style.display = 'none';
            errorMessageElement.textContent = '';
            emailInput.classList.remove('input-error');

            // If input is empty, don't show error yet (handled on button click)
            if (!email) {
                return;
            }

            // Basic email format validation regex (requires text before @gmail.com)
            const emailRegex = /^[^\s@]+@gmail\.com$/;

            // Check if it matches the required format (text@gmail.com)
            if (!emailRegex.test(email)) {
                // Show error message for invalid format
                errorMessageElement.innerHTML = '<i class="fas fa-exclamation-circle" style="color: white; background: red; border-radius: 50%; width: 16px; height: 16px; display: inline-flex; align-items: center; justify-content: center; margin-right: 5px;"></i> Please enter a valid email address.';
                errorMessageElement.style.display = 'flex'; // Show the new error message span
                emailInput.classList.add('input-error'); // Highlight input field
                // No need to focus here as it's real-time
                return; // Exit the function early
            }

            // If validation passes (format looks okay), hide any error message
            errorMessageElement.style.display = 'none';
            emailInput.classList.remove('input-error');
        }

        // >>> CHANGED: Updated resetPassword function with comprehensive validation and modal display
        function resetPassword() {
            const emailInput = document.getElementById('resetEmail');
            const email = emailInput.value.trim().toLowerCase();
            const messageElement = document.getElementById('resetMessage'); // General message (hidden)
            const errorMessageElement = document.getElementById('reset-email-error'); // Specific error message span

            // Clear previous messages and error states
            messageElement.textContent = ''; // Clear hidden general message
            messageElement.style.display = 'none';
            errorMessageElement.style.display = 'none';
            errorMessageElement.textContent = '';
            emailInput.classList.remove('input-error');

            // Check if email is empty
            if (!email) {
                // Show specific error message for empty email in the general message area (for compatibility)
                messageElement.innerHTML = '<i class="fas fa-exclamation-circle" style="color: white; background: red; border-radius: 50%; width: 16px; height: 16px; display: inline-flex; align-items: center; justify-content: center; margin-right: 5px;"></i> Email address is required to reset your password.';
                messageElement.style.color = 'red';
                messageElement.style.display = 'block'; // Show the general message paragraph
                emailInput.focus();
                return; // Exit the function early
            }

            // Basic email format validation regex (requires text before @gmail.com)
            const emailRegex = /^[^\s@]+@gmail\.com$/;

            // Check if it matches the required format (text@gmail.com)
            if (!emailRegex.test(email)) {
                // Show error message for invalid format in the specific error span
                errorMessageElement.innerHTML = '<i class="fas fa-exclamation-circle" style="color: white; background: red; border-radius: 50%; width: 16px; height: 16px; display: inline-flex; align-items: center; justify-content: center; margin-right: 5px;"></i> Please enter a valid email address.';
                errorMessageElement.style.display = 'flex'; // Show the new error message span
                emailInput.classList.add('input-error'); // Highlight input field
                emailInput.focus();
                return; // Exit the function early
            }

            // If validation passes (format looks okay), proceed
            // In a real app, you would send the request to your backend here.
            // For now, we'll just show the success modal.

            // Optional: Check if user exists (depends on your backend logic)
            // const users = JSON.parse(localStorage.getItem('users')) || [];
            // const user = users.find(u => u.email === email) || email === 'user@clmb.sti.archives' || email === 'admin@clmb.sti.archives';
            //
            // if (!user) {
            //     errorMessageElement.textContent = 'No account found with this email address.';
            //     errorMessageElement.style.color = '#ff6b6b';
            //     errorMessageElement.style.display = 'block';
            //     return;
            // }

            // Close the reset modal
            closeResetModal();
            // Show the new "Reset was sent" modal
            showResetSentModal();
        }

        // >>> NEW: Function to show the Reset Sent modal
        function showResetSentModal() {
            const modal = document.getElementById('resetSentModal');
            modal.style.display = 'block';
            // Hide the modal after 3 seconds
            setTimeout(() => {
                modal.style.display = 'none';
            }, 3000);
        }
        const adminEmailInput = document.getElementById('admin-login-email');
        const adminEmailError = document.getElementById('admin-login-email-error');
        const adminPasswordInput = document.getElementById('admin-login-password');
        const adminPasswordError = document.getElementById('admin-login-password-error');
        const adminLoginForm = document.getElementById('adminloginForm');
        const adminLoginMessage = document.getElementById('admin-login-message');
        function validateAdminEmail() {
            const email = adminEmailInput.value.trim();
            const emailRegex = /^[A-Za-z0-9._%+-]+@clmb\.sti\.archives$/;
            if (!email) {
                adminEmailError.innerHTML = '<i class="fas fa-exclamation-circle"></i> Only emails from @clmb.sti.archives are accepted.';
                adminEmailError.style.display = 'flex';
                adminEmailInput.classList.add('input-error');
                return false;
            } else if (!emailRegex.test(email)) {
                adminEmailError.innerHTML = '<i class="fas fa-exclamation-circle"></i> Only emails from @clmb.sti.archives are accepted.';
                adminEmailError.style.display = 'flex';
                adminEmailInput.classList.add('input-error');
                return false;
            } else {
                adminEmailError.style.display = 'none';
                adminEmailInput.classList.remove('input-error');
                return true;
            }
        }
        if (adminEmailInput) {
            adminEmailInput.addEventListener('input', () => {
                if (adminEmailError.style.display === 'flex') {
                    const email = adminEmailInput.value.trim();
                    const emailRegex = /^[A-Za-z0-9._%+-]+@clmb\.sti\.archives$/;
                    if (email && emailRegex.test(email)) {
                        adminEmailError.style.display = 'none';
                        adminEmailInput.classList.remove('input-error');
                    }
                }
            });
        }
        function validateAdminPassword() {
            const password = adminPasswordInput.value;
            if (!password) {
                adminPasswordError.innerHTML = '<i class="fas fa-exclamation-circle"></i> Password is required';
                adminPasswordError.style.display = 'flex';
                adminPasswordInput.classList.add('input-error');
                return false;
            } else if (password.length < 8) {
                adminPasswordError.innerHTML = '<i class="fas fa-exclamation-circle"></i> Password must be at least 8 characters long.';
                adminPasswordError.style.display = 'flex';
                adminPasswordInput.classList.add('input-error');
                return false;
            } else {
                adminPasswordError.style.display = 'none';
                adminPasswordInput.classList.remove('input-error');
                return true;
            }
        }
        if (adminPasswordInput) {
            adminPasswordInput.addEventListener('input', () => {
                if (adminPasswordError.style.display === 'flex') {
                    const password = adminPasswordInput.value;
                    if (password.length >= 8) {
                        adminPasswordError.style.display = 'none';
                        adminPasswordInput.classList.remove('input-error');
                    }
                }
            });
        }
        // Note: Admin login is now handled in the main login form above.
        // const adminCredentials = [
        //     { email: 'admin@clmb.sti.archives', password: 'admin123', name: 'Permanent Admin', role: 'admin', id: 'admin-permanent' }
        // ];
        // adminLoginForm.addEventListener('submit', function(e) {
        //     e.preventDefault();
        //     const email = adminEmailInput.value.trim().toLowerCase();
        //     const password = adminPasswordInput.value;
        //     const rememberMe = document.getElementById('admin-rememberMe').checked;
        //     adminEmailError.style.display = 'none';
        //     adminPasswordError.style.display = 'none';
        //     adminEmailInput.classList.remove('input-error');
        //     adminPasswordInput.classList.remove('input-error');
        //     adminLoginMessage.style.display = 'none';
        //     let hasErrors = false;
        //     const emailRegex = /^[A-Za-z0-9._%+-]+@calamba\.sti\.edu\.ph$/;
        //     if (!email) {
        //         adminEmailError.innerHTML = '<i class="fas fa-exclamation-circle"></i> Only emails from @calamba.sti.edu.ph are accepted.';
        //         adminEmailError.style.display = 'flex';
        //         adminEmailInput.classList.add('input-error');
        //         hasErrors = true;
        //     } else if (!emailRegex.test(email)) {
        //         adminEmailError.innerHTML = '<i class="fas fa-exclamation-circle"></i> Only emails from @calamba.sti.edu.ph are accepted.';
        //         adminEmailError.style.display = 'flex';
        //         adminEmailInput.classList.add('input-error');
        //         hasErrors = true;
        //     }
        //     if (!password) {
        //         adminPasswordError.innerHTML = '<i class="fas fa-exclamation-circle"></i> Password is required';
        //         adminPasswordError.style.display = 'flex';
        //         adminPasswordInput.classList.add('input-error');
        //         hasErrors = true;
        //     } else if (password.length < 8) {
        //         adminPasswordError.innerHTML = '<i class="fas fa-exclamation-circle"></i> Password must be at least 8 characters long.';
        //         adminPasswordError.style.display = 'flex';
        //         adminPasswordInput.classList.add('input-error');
        //         hasErrors = true;
        //     }
        //     if (hasErrors) {
        //         adminLoginMessage.style.display = 'none';
        //         return;
        //     }
        //     const admin = adminCredentials.find(u => u.email === email);
        //     if (admin && admin.password === password) {
        //         localStorage.setItem('currentUser', JSON.stringify(admin));
        //         if (rememberMe) {
        //             localStorage.setItem('adminRememberMe', email);
        //         } else {
        //             localStorage.removeItem('adminRememberMe');
        //         }
        //         adminLoginMessage.textContent = 'Successfully logged in as admin!';
        //         adminLoginMessage.style.color = 'green';
        //         adminLoginMessage.style.display = 'block';
        //         setTimeout(() => {
        //             window.location.href = "admin.html";
        //         }, 2000);
        //     } else {
        //         if (admin) {
        //             adminLoginMessage.textContent = 'Invalid password. Please try again.';
        //             adminLoginMessage.style.color = '#ff6b6b';
        //             adminLoginMessage.style.display = 'block';
        //         } else {
        //             adminLoginMessage.textContent = 'No account found with this email address.';
        //             adminLoginMessage.style.color = '#ff6b6b';
        //             adminLoginMessage.style.display = 'block';
        //         }
        //     }
        // });
        // const rememberedAdminEmail = localStorage.getItem('adminRememberMe');
        // if (rememberedAdminEmail) {
        //     adminEmailInput.value = rememberedAdminEmail;
        //     document.getElementById('admin-rememberMe').checked = true;
        // }
        // const adminForgotPasswordLink = document.getElementById('admin-forgotPassword');
        // if (adminForgotPasswordLink) {
        //     adminForgotPasswordLink.addEventListener('click', function(e) {
        //         e.preventDefault();
        //         document.getElementById('forgotPasswordModal').classList.add('show');
        //         document.body.style.overflow = 'hidden';
        //     });
        // }
        function openModal(modalId) {
            const modal = document.getElementById(modalId);
            modal.classList.add('show');
            document.body.style.overflow = 'hidden';
        }
        function closeModal(modalId) {
            const modal = document.getElementById(modalId);
            modal.classList.remove('show');
            document.body.style.overflow = 'auto';
        }
        window.addEventListener('click', function(e) {
            const termsModal = document.getElementById('termsModal');
            const privacyModal = document.getElementById('privacyModal');
            if (e.target === termsModal) {
                closeModal('termsModal');
            }
            if (e.target === privacyModal) {
                closeModal('privacyModal');
            }
        });
        document.getElementById('termsLink').addEventListener('click', function(e) {
            e.preventDefault();
            openModal('termsModal');
        });
        document.getElementById('privacyLink').addEventListener('click', function(e) {
            e.preventDefault();
            openModal('privacyModal');
        });
        document.getElementById('termsLinkSignup').addEventListener('click', function(e) {
            e.preventDefault();
            openModal('termsModal');
        });
        document.getElementById('privacyLinkSignup').addEventListener('click', function(e) {
            e.preventDefault();
            openModal('privacyModal');
        });
        const termsLogin = document.getElementById('terms-login');
        const termsSignup = document.getElementById('terms-signup');
        function syncCheckboxes() {
            termsSignup.checked = termsLogin.checked;
        }
        termsLogin.addEventListener('change', syncCheckboxes);
        termsSignup.addEventListener('change', function() {
            termsLogin.checked = termsSignup.checked;
        });

        // >>> FIXED: Welcome Modal - 7 seconds + click outside (not inside) to close + SHOW ON LOAD
        const welcomeModal = document.getElementById('welcomeModal');
        if (welcomeModal) {
            // Check if we should show access granted modal instead
            const urlParams = new URLSearchParams(window.location.search);
            const showAccessGranted = urlParams.get('access_granted') === 'true' || sessionStorage.getItem('showAccessGranted') === 'true';

            if (showAccessGranted) {
                // Clear the flag
                sessionStorage.removeItem('showAccessGranted');
                // Show access granted modal instead of welcome modal
                showAccessGrantedModal();
                // Remove the query parameter from URL
                window.history.replaceState({}, document.title, window.location.pathname);
            } else {
                // Modal is displayed by default in CSS
                // Auto-hide after 7 seconds
                setTimeout(() => {
                    welcomeModal.style.display = 'none'; // Hide the modal
                }, 7000);
            }

            // Click outside (on the overlay part) to close - FIXED
            // This is now handled in the general window click listener above
        }

        function previewRaf(path) {
            const modal = document.getElementById('raf-preview-modal');
            const content = document.getElementById('raf-preview-content');
            if (path.endsWith('.pdf')) {
                content.innerHTML = `<iframe src="${path}" width="100%" height="600px"></iframe>`;
            } else if (path.match(/\.(doc|docx)$/)) {
                content.innerHTML = `<p>Document preview not available. <a href="${path}" target="_blank" download>Download RAF</a></p>`;
            } else {
                content.innerHTML = `<p>Preview not available for this file type.</p>`;
            }
            modal.style.display = 'flex';
        }
        function closeRafModal() {
            document.getElementById('raf-preview-modal').style.display = 'none';
        }
        window.previewRaf = previewRaf;
        // >>> NEW: Show Success Login Modal
        function showSuccessModal() {
            const modal = document.getElementById('successLoginModal');
            modal.style.display = 'block';
            setTimeout(() => {
                modal.style.display = 'none';
            }, 3000);
        }
        // >>> NEW: Show Access Granted Modal for newly verified users
        function showAccessGrantedModal() {
            const modal = document.getElementById('accessGrantedModal');
            modal.style.display = 'block';
            setTimeout(() => {
                modal.style.display = 'none';
                // Reload the page after showing the modal
                window.location.reload();
            }, 3000);
        }
        </script>
    </body>
    </html>